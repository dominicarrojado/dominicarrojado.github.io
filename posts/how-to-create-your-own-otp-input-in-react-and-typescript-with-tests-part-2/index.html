<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1"/><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#2c2c34"/><link rel="icon" href="https://dominicarrojado.com/favicon.ico"/><link rel="manifest" href="https://dominicarrojado.com/manifest.json"/><meta name="twitter:card" content="summary_large_image"/><meta property="og:image" content="https://dominicarrojado.com/images/pages/guides-tips-and-tricks-to-web-development.png"/><meta property="og:image:alt" content="Dominic Arrojado | Guides, Tips and Tricks to Web Development"/><meta property="og:image:type" content="image/png"/><meta property="og:image:width" content="2400"/><meta property="og:image:height" content="1254"/><meta property="og:site_name" content="Dominic Arrojado"/><link rel="preload" href="/fonts/Roboto-Light.woff2" as="font" type="font/woff2" crossorigin="anonymous"/><link rel="preload" href="/fonts/Roboto-Light.woff" as="font" type="font/woff" crossorigin="anonymous"/><link rel="preload" href="/fonts/Roboto-LightItalic.woff2" as="font" type="font/woff2" crossorigin="anonymous"/><link rel="preload" href="/fonts/Roboto-LightItalic.woff" as="font" type="font/woff" crossorigin="anonymous"/><link rel="preload" href="/fonts/Roboto-Regular.woff2" as="font" type="font/woff2" crossorigin="anonymous"/><link rel="preload" href="/fonts/Roboto-Regular.woff" as="font" type="font/woff" crossorigin="anonymous"/><link rel="preload" href="/fonts/Roboto-Italic.woff2" as="font" type="font/woff2" crossorigin="anonymous"/><link rel="preload" href="/fonts/Roboto-Italic.woff" as="font" type="font/woff" crossorigin="anonymous"/><link rel="preload" href="/fonts/Roboto-Medium.woff2" as="font" type="font/woff2" crossorigin="anonymous"/><link rel="preload" href="/fonts/Roboto-Medium.woff" as="font" type="font/woff" crossorigin="anonymous"/><link rel="preload" href="/fonts/Roboto-MediumItalic.woff2" as="font" type="font/woff2" crossorigin="anonymous"/><link rel="preload" href="/fonts/Roboto-MediumItalic.woff" as="font" type="font/woff" crossorigin="anonymous"/><link rel="preload" href="/fonts/Roboto-Bold.woff2" as="font" type="font/woff2" crossorigin="anonymous"/><link rel="preload" href="/fonts/Roboto-Bold.woff" as="font" type="font/woff" crossorigin="anonymous"/><link rel="preload" href="/fonts/Roboto-BoldItalic.woff2" as="font" type="font/woff2" crossorigin="anonymous"/><link rel="preload" href="/fonts/Roboto-BoldItalic.woff" as="font" type="font/woff" crossorigin="anonymous"/><title>How to create your own OTP input in React and TypeScript with tests (Part 2) | Dominic Arrojado</title><meta name="robots" content="index,follow"/><meta name="description" content="Learn how to build a modern OTP input component in a reactive and reusable way"/><meta property="og:title" content="How to create your own OTP input in React and TypeScript with tests (Part 2) | Dominic Arrojado"/><meta property="og:description" content="Learn how to build a modern OTP input component in a reactive and reusable way"/><meta property="og:url" content="https://dominicarrojado.com/posts/how-to-create-your-own-otp-input-in-react-and-typescript-with-tests-part-2/"/><meta property="og:type" content="article"/><meta property="article:published_time" content="2022-06-16T14:00:00Z"/><meta property="article:modified_time" content="2022-06-16T14:00:00Z"/><meta property="article:author" content="https://dominicarrojado.com/about/"/><link rel="canonical" href="https://dominicarrojado.com/posts/how-to-create-your-own-otp-input-in-react-and-typescript-with-tests-part-2/"/><meta name="next-head-count" content="39"/><link rel="preload" href="/_next/static/css/15a71a53b857db9b.css" as="style"/><link rel="stylesheet" href="/_next/static/css/15a71a53b857db9b.css" data-n-g=""/><link rel="preload" href="/_next/static/css/82d01f71dc75279c.css" as="style"/><link rel="stylesheet" href="/_next/static/css/82d01f71dc75279c.css" data-n-p=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-5cd94c89d3acac5f.js"></script><script src="/_next/static/chunks/webpack-6d9d10b8fc4eebc8.js" defer=""></script><script src="/_next/static/chunks/framework-433e73989db4e225.js" defer=""></script><script src="/_next/static/chunks/main-c51b0b3c89045435.js" defer=""></script><script src="/_next/static/chunks/pages/_app-6604ec4620e3d16a.js" defer=""></script><script src="/_next/static/chunks/216-1077b041778ead2e.js" defer=""></script><script src="/_next/static/chunks/466-2aafae0e90314603.js" defer=""></script><script src="/_next/static/chunks/pages/posts/%5Bid%5D-101bdca647312681.js" defer=""></script><script src="/_next/static/w_lcLaTtnDc8K5YgyDF9D/_buildManifest.js" defer=""></script><script src="/_next/static/w_lcLaTtnDc8K5YgyDF9D/_ssgManifest.js" defer=""></script><script src="/_next/static/w_lcLaTtnDc8K5YgyDF9D/_middlewareManifest.js" defer=""></script></head><body><div id="__next" data-reactroot=""><noscript>
            <iframe
              src="https://www.googletagmanager.com/ns.html?id=GTM-TSMLTPT"
              height="0"
              width="0"
              style="display: none; visibility: hidden"
            ></iframe>
          </noscript><div tabindex="-1" class="h-full outline-none"><header><a href="#main" tabindex="0" class="absolute -top-96 -left-96 w-px h-px text-center text-white overflow-hidden -z-50 focus:top-4 focus:inset-x-0 focus:m-auto focus:w-44 focus:h-auto focus:z-50 focus:sm:w-52 focus:xl:w-56">Skip to main content</a><a class="group fixed top-3.5 left-3.5 z-50 flex shadow-3xl border border-white bg-gray-750 bg-opacity-90 p-1.5 transform transition ease-in-out duration-500 hover:shadow-md hover:bg-opacity-100 motion-reduce:transition-none sm:top-4 sm:left-4 md:top-6 md:left-8 md:border-2 xl:left-9 xl:p-2 delay-700 opacity-0 -translate-y-full" aria-label="Dominic Arrojado logo" href="/"><svg viewBox="0 0 25750 29700" role="img" class="w-7 h-7 text-white transition-colors duration-300 sm:w-8 sm:h-8 md:w-10 md:h-10 xl:w-11 xl:h-11"><path fill="currentColor" d="M4850 19266H1025V2039l4600-129c2511 0 4500 735 5970 2206 1470 1470 2206 3423 2206 5854 0 6199-2985 9296-8951 9296zM4086 4719v11751c494 48 1025 72 1599 72 1543 0 2752-558 3624-1679s1310-2688 1310-4705c0-3684-1712-5524-5135-5524-329 0-795 28-1398 85zm17656 21711l-1437-3969h-6721l974-2655h4730l-2242-6854 1518-4167 7010 17645zM17826 435h3307L10351 29313H7044l4243-11322c1982-1513 2973-4055 2973-7627 0-171-4-340-11-506l3577-9423z"></path></svg></a><div class="fixed flex items-end top-3 right-1 z-50 sm:right-2 md:top-6 md:right-4 xl:top-7" data-testid="header-buttons"><button type="button" aria-expanded="false" aria-controls="dialog-menu" aria-haspopup="dialog" class="group flex items-center flex-col min-w-12 pt-3 pb-2 px-2 outline-none md:min-w-15.5 md:px-3 xl:min-w-18.5"><div class="w-6 h-0.5 bg-gray-400 rounded dark:bg-gray-300 transform transition group-hover:bg-gray-500 group-focus-visible:bg-gray-500 motion-reduce:transition-none dark:group-hover:bg-white dark:group-focus-visible:bg-white md:w-7 md:h-1 xl:w-8 duration-1000 opacity-0 translate-x-1/2" style="transition-delay:500ms" data-testid="menu-stack"></div><div class="w-6 h-0.5 bg-gray-400 rounded dark:bg-gray-300 transform transition group-hover:bg-gray-500 group-focus-visible:bg-gray-500 motion-reduce:transition-none dark:group-hover:bg-white dark:group-focus-visible:bg-white md:w-7 md:h-1 xl:w-8 mt-1.5 duration-1000 opacity-0 -translate-x-1/2" style="transition-delay:650ms" data-testid="menu-stack"></div><div class="w-6 h-0.5 bg-gray-400 rounded dark:bg-gray-300 transform transition group-hover:bg-gray-500 group-focus-visible:bg-gray-500 motion-reduce:transition-none dark:group-hover:bg-white dark:group-focus-visible:bg-white md:w-7 md:h-1 xl:w-8 mt-1.5 duration-1000 opacity-0 translate-x-1/2" style="transition-delay:800ms" data-testid="menu-stack"></div><div class="mt-1.5 text-gray-400 text-3xs font-normal uppercase select-none dark:text-gray-300 transform transition-transform-opacity-color group-hover:text-gray-500 motion-reduce:transition-none dark:group-hover:text-gray-100 md:mt-2 md:text-2xs xl:text-xs duration-700 delay-1000 opacity-0 -translate-y-3">Menu</div></button></div><div class="hidden lg:block lg:fixed lg:bottom-3 lg:right-7 lg:z-40" data-testid="header-social"><ul class="max-w-full mt-10 flex flex-wrap justify-center lg:mt-0"><li class="flex lg:transform lg:transition lg:ease-in-out lg:duration-500 motion-reduce:lg:transition-none lg:opacity-0 lg:translate-y-full" style="transition-delay:2050ms"><a target="_blank" rel="noopener noreferrer nofollow" tabindex="0" aria-describedby="tooltip-donate" href="https://www.paypal.com/paypalme/DominicArrojado" class="group inline-flex p-3 cursor-pointer sm:p-4" aria-label="Show your support and donate!"><svg viewBox="0 0 512 512" role="img" class="w-7 h-7 text-gray-400 dark:text-gray-300 transition-colors group-hover:text-gray-500 motion-reduce:transition-none dark:group-hover:text-white sm:w-8 sm:h-8 xl:w-9 xl:h-9"><path fill="currentColor" d="M256 416c114.9 0 208-93.1 208-208S370.9 0 256 0 48 93.1 48 208s93.1 208 208 208zM233.8 97.4V80.6c0-9.2 7.4-16.6 16.6-16.6h11.1c9.2 0 16.6 7.4 16.6 16.6v17c15.5.8 30.5 6.1 43 15.4 5.6 4.1 6.2 12.3 1.2 17.1L306 145.6c-3.8 3.7-9.5 3.8-14 1-5.4-3.4-11.4-5.1-17.8-5.1h-38.9c-9 0-16.3 8.2-16.3 18.3 0 8.2 5 15.5 12.1 17.6l62.3 18.7c25.7 7.7 43.7 32.4 43.7 60.1 0 34-26.4 61.5-59.1 62.4v16.8c0 9.2-7.4 16.6-16.6 16.6h-11.1c-9.2 0-16.6-7.4-16.6-16.6v-17c-15.5-.8-30.5-6.1-43-15.4-5.6-4.1-6.2-12.3-1.2-17.1l16.3-15.5c3.8-3.7 9.5-3.8 14-1 5.4 3.4 11.4 5.1 17.8 5.1h38.9c9 0 16.3-8.2 16.3-18.3 0-8.2-5-15.5-12.1-17.6l-62.3-18.7c-25.7-7.7-43.7-32.4-43.7-60.1.1-34 26.4-61.5 59.1-62.4zM480 352h-32.5c-19.6 26-44.6 47.7-73 64h63.8c5.3 0 9.6 3.6 9.6 8v16c0 4.4-4.3 8-9.6 8H73.6c-5.3 0-9.6-3.6-9.6-8v-16c0-4.4 4.3-8 9.6-8h63.8c-28.4-16.3-53.3-38-73-64H32c-17.7 0-32 14.3-32 32v96c0 17.7 14.3 32 32 32h448c17.7 0 32-14.3 32-32v-96c0-17.7-14.3-32-32-32z"></path></svg></a></li><li class="flex lg:transform lg:transition lg:ease-in-out lg:duration-500 motion-reduce:lg:transition-none lg:opacity-0 lg:translate-y-full" style="transition-delay:2200ms"><a target="_blank" rel="noopener noreferrer nofollow" tabindex="0" aria-describedby="tooltip-youtube" href="https://www.youtube.com/channel/UCWwV__qrzg5BYCSwO91Xhxg/videos?view=0&amp;sort=dd" class="group inline-flex p-3 cursor-pointer sm:p-4" aria-label="Watch my tech videos!"><svg viewBox="0 0 576 512" role="img" class="w-7 h-7 text-gray-400 dark:text-gray-300 transition-colors group-hover:text-gray-500 motion-reduce:transition-none dark:group-hover:text-white sm:w-8 sm:h-8 xl:w-9 xl:h-9"><path fill="currentColor" d="M549.655 124.083c-6.281-23.65-24.787-42.276-48.284-48.597C458.781 64 288 64 288 64S117.22 64 74.629 75.486c-23.497 6.322-42.003 24.947-48.284 48.597-11.412 42.867-11.412 132.305-11.412 132.305s0 89.438 11.412 132.305c6.281 23.65 24.787 41.5 48.284 47.821C117.22 448 288 448 288 448s170.78 0 213.371-11.486c23.497-6.321 42.003-24.171 48.284-47.821 11.412-42.867 11.412-132.305 11.412-132.305s0-89.438-11.412-132.305zm-317.51 213.508V175.185l142.739 81.205-142.739 81.201z"></path></svg></a></li><li class="flex lg:transform lg:transition lg:ease-in-out lg:duration-500 motion-reduce:lg:transition-none lg:opacity-0 lg:translate-y-full" style="transition-delay:2350ms"><a target="_blank" rel="noopener noreferrer nofollow" tabindex="0" aria-describedby="tooltip-linkedin" href="https://www.linkedin.com/in/dominic-arrojado-75ba03a9/" class="group inline-flex p-3 cursor-pointer sm:p-4" aria-label="Let&#x27;s connect on LinkedIn!"><svg viewBox="0 0 448 512" role="img" class="w-7 h-7 text-gray-400 dark:text-gray-300 transition-colors group-hover:text-gray-500 motion-reduce:transition-none dark:group-hover:text-white sm:w-8 sm:h-8 xl:w-9 xl:h-9"><path fill="currentColor" d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9V416z"></path></svg></a></li><li class="flex lg:transform lg:transition lg:ease-in-out lg:duration-500 motion-reduce:lg:transition-none lg:opacity-0 lg:translate-y-full" style="transition-delay:2500ms"><a target="_blank" rel="noopener noreferrer nofollow" tabindex="0" aria-describedby="tooltip-github" href="https://github.com/dominicarrojado/" class="group inline-flex p-3 cursor-pointer sm:p-4" aria-label="Follow me on GitHub!"><svg viewBox="0 0 496 512" role="img" class="w-7 h-7 text-gray-400 dark:text-gray-300 transition-colors group-hover:text-gray-500 motion-reduce:transition-none dark:group-hover:text-white sm:w-8 sm:h-8 xl:w-9 xl:h-9"><path fill="currentColor" d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"></path></svg></a></li><li class="flex lg:transform lg:transition lg:ease-in-out lg:duration-500 motion-reduce:lg:transition-none lg:opacity-0 lg:translate-y-full" style="transition-delay:2650ms"><a target="_blank" rel="noopener noreferrer nofollow" tabindex="0" aria-describedby="tooltip-email" href="mailto:dominicarrojado@gmail.com" class="group inline-flex p-3 cursor-pointer sm:p-4" aria-label="Email me!"><svg viewBox="0 0 512 512" role="img" class="w-7 h-7 text-gray-400 dark:text-gray-300 transition-colors group-hover:text-gray-500 motion-reduce:transition-none dark:group-hover:text-white sm:w-8 sm:h-8 xl:w-9 xl:h-9"><path fill="currentColor" d="M502.3 190.8c3.9-3.1 9.7-.2 9.7 4.7V400c0 26.5-21.5 48-48 48H48c-26.5 0-48-21.5-48-48V195.6c0-5 5.7-7.8 9.7-4.7 22.4 17.4 52.1 39.5 154.1 113.6 21.1 15.4 56.7 47.8 92.2 47.6 35.7.3 72-32.8 92.3-47.6 102-74.1 131.6-96.3 154-113.7zM256 320c23.2.4 56.6-29.2 73.4-41.4 132.7-96.3 142.8-104.7 173.4-128.7 5.8-4.5 9.2-11.5 9.2-18.9v-19c0-26.5-21.5-48-48-48H48C21.5 64 0 85.5 0 112v19c0 7.4 3.4 14.3 9.2 18.9 30.6 23.9 40.7 32.4 173.4 128.7 16.8 12.2 50.2 41.8 73.4 41.4z"></path></svg></a></li></ul></div></header><div id="main"></div><section class="relative flex flex-col justify-center bg-gray-550 py-28 px-6 text-center overflow-hidden dark:bg-gray-750 transform transition-transform ease-in-out duration-500 motion-reduce:transition-none sm:px-20 lg:px-32 min-h-96 -translate-y-full" data-testid="container"><div class="absolute top-0 left-0 w-full h-full bg-repeat bg-center invert-[.1] dark:invert-0 motion-safe:animate-slide transition-opacity duration-1250 delay-500 motion-reduce:transition-none opacity-0" style="background-image:url(&#x27;/images/bg/pattern.png&#x27;)" data-testid="background"></div><div class="overflow-hidden py-2" style="opacity:1"><h1 class="text-3xl font-bold text-white leading-tight transform transition duration-1000 delay-500 motion-reduce:transition-none sm:text-4xl md:text-5xl lg:text-6xl xl:text-7xl opacity-0 translate-y-full">How to create your own OTP input in React and TypeScript with tests (Part 2)</h1></div><div class="overflow-hidden" style="opacity:1"><p class="font-light text-white transform transition duration-1000 delay-1000 motion-reduce:transition-none xl:text-2xl opacity-0 translate-y-full">Learn how to build a modern OTP input component in a reactive and reusable way</p></div></section><section class="pt-16 pb-20 px-6 sm:pt-20 sm:pb-24 sm:px-8 md:pt-24 md:pb-28 lg:px-10 xl:pt-28 xl:pb-32 transform transition-transform-opacity duration-1000 motion-reduce:transition-none delay-1500 opacity-0 translate-y-10" data-testid="section"><div class="w-11/12 max-w-screen-3xl -mt-8 mx-auto pb-8 sm:-mt-10 sm:pb-10 md:-mt-12 md:pb-12 lg:w-5/6"><ins class="adsbygoogle block max-w-[1200px] mx-auto adUnit_adunit__Qsm4B" data-ad-client="ca-pub-3632473845121107" data-ad-slot="4984498713" data-ad-format="auto" data-full-width-responsive="true" data-testid="ad-unit"></ins></div><div class="flex justify-between items-center w-11/12 max-w-screen-3xl mx-auto lg:w-5/6"><div class="mr-4 text-sm text-gray-400 sm:text-base xl:text-lg">Last Updated: <time dateTime="2022-06-16">June 16, 2022</time></div><div class="rounded py-0.5 px-1.5 bg-gray-200 text-2xs capitalize dark:bg-gray-600 md:py-1 md:px-2 md:text-xs xl:text-sm">technology</div></div><div class="w-11/12 max-w-screen-3xl mt-4 mx-auto lg:w-5/6"><a class="group inline-flex items-center font-normal select-none dark:hover:text-white transition-colors duration-300 hover:text-black group-hover:text-black motion-reduce:transition-none" target="_blank" rel="noopener noreferrer nofollow" href="https://youtu.be/s6MFjcCen2A"><svg viewBox="0 0 576 512" role="img" class="w-6 h-6 mr-2 text-gray-400 transition-colors duration-300 group-hover:text-red motion-reduce:transition-none dark:group-hover:text-white sm:w-7 sm:h-7 sm:mr-3 xl:w-8 xl:h-8"><path fill="currentColor" d="M549.655 124.083c-6.281-23.65-24.787-42.276-48.284-48.597C458.781 64 288 64 288 64S117.22 64 74.629 75.486c-23.497 6.322-42.003 24.947-48.284 48.597-11.412 42.867-11.412 132.305-11.412 132.305s0 89.438 11.412 132.305c6.281 23.65 24.787 41.5 48.284 47.821C117.22 448 288 448 288 448s170.78 0 213.371-11.486c23.497-6.321 42.003-24.171 48.284-47.821 11.412-42.867 11.412-132.305 11.412-132.305s0-89.438-11.412-132.305zm-317.51 213.508V175.185l142.739 81.205-142.739 81.201z"></path></svg> <!-- -->Watch it on YouTube<svg viewBox="0 0 320 512" role="img" class="inline-block w-2 h-2 ml-2 text-black opacity-30 dark:text-white transform transition duration-300 group-hover:translate-x-1.5 group-hover:opacity-100 motion-reduce:transition-none sm:w-2.5 sm:h-2.5 sm:ml-2.5 md:w-3 md:h-3 md:ml-3 xl:w-3.5 xl:h-3.5"><path fill="currentColor" d="M285.476 272.971L91.132 467.314c-9.373 9.373-24.569 9.373-33.941 0l-22.667-22.667c-9.357-9.357-9.375-24.522-.04-33.901L188.505 256 34.484 101.255c-9.335-9.379-9.317-24.544.04-33.901l22.667-22.667c9.373-9.373 24.569-9.373 33.941 0L285.475 239.03c9.373 9.372 9.373 24.568.001 33.941z"></path></svg></a></div><article class="w-11/12 max-w-screen-3xl mx-auto prose dark:prose-dark sm:prose-lg lg:w-5/6 xl:prose-xl mt-8 sm:mt-10 xl:mt-14" data-clarity-region="article" data-testid="content"><h2>Introduction</h2>
<p>This is a continuation from <a href="/posts/how-to-create-your-own-otp-input-in-react-and-typescript-with-tests-part-1/">Part 1</a>.</p>
<h2>Prerequisites</h2>
<p>To get started with testing, first install the package below:</p>
<pre><code class="hljs language-bash">yarn add @faker-js/faker
</code></pre>
<p><a target="_blank" rel="noopener noreferrer nofollow" href="https://github.com/faker-js/faker"><code>@faker-js/faker</code></a> helps us generate massive amounts of fake (but realistic) data for testing. Check out the guide for <code>faker</code> <a target="_blank" rel="noopener noreferrer nofollow" href="https://fakerjs.dev/guide/">here</a>.</p>
<div><ins class="adsbygoogle block max-w-[1200px] mx-auto adUnit_adunit__Qsm4B" data-ad-client="ca-pub-3632473845121107" data-ad-slot="3748487753" data-ad-format="fluid" data-ad-layout="in-article" data-full-width-responsive="true" data-testid="ad-unit"></ins></div>
<h2>Write tests for props</h2>
<p>For test files, I like to separate them in a folder so that it&#x27;s less cluttered when viewing the main files. Create a new folder named <code>__tests__</code> under the <code>src/components</code>. This is where we will put the test files for the components under <code>src/components</code> folder.</p>
<p>Since we are writing tests for <code>OtpInput</code> component, create a file under <code>src/components/__tests__</code> and name it <code>OtpInput.test.tsx</code>. This is a common naming convention for test files, make sure it matches the name of the component you are testing.</p>
<p>Then let&#x27;s add in the structure of the test:</p>
<pre><code class="hljs language-tsx"><span class="hljs-keyword">import</span> OtpInput, { Props } <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;../OtpInput&#x27;</span>;

describe(<span class="hljs-string">&#x27;&lt;OtpInput /&gt;&#x27;</span>, <span class="hljs-function">() =&gt;</span> {});
</code></pre>
<p>Aside from importing the component that we will test, we also imported the type <code>Props</code>. You&#x27;ll get to know why we did that later on.</p>
<p><code>describe</code> is one of Jest&#x27;s global functions, so with the setup of Create React App, we don&#x27;t need to specifically import these global functions in our code, we can just directly use them. <code>describe</code> creates a block that groups together several related tests. So ideally the description should be describing what we are testing, so in this case I used the component name. Feel free to rename it according to your preference.</p>
<p>Next we can add a test case inside the <code>describe</code> block:</p>
<pre><code class="hljs language-tsx"><span class="hljs-keyword">import</span> OtpInput, { Props } <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;../OtpInput&#x27;</span>;

describe(<span class="hljs-string">&#x27;&lt;OtpInput /&gt;&#x27;</span>, <span class="hljs-function">() =&gt;</span> {
  it(<span class="hljs-string">&#x27;should accept value &amp; valueLength props&#x27;</span>, <span class="hljs-function">() =&gt;</span> {});
});
</code></pre>
<p>The <code>it</code> (or <code>test</code>) method is another global function by Jest that runs a test. This is where we can have different test cases. Let&#x27;s start to populate our first test case. First you want to do is to create a reusable function <code>renderComponent</code> inside the <code>describe</code> block, it should accepts the props of our component as an argument and calls the <code>render()</code> method from Testing Library to render our component with the passed props in a test environment.</p>
<pre><code class="hljs language-tsx"><span class="hljs-keyword">import</span> { render } <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;@testing-library/react&#x27;</span>;
<span class="hljs-keyword">import</span> OtpInput, { Props } <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;../OtpInput&#x27;</span>;

describe(<span class="hljs-string">&#x27;&lt;OtpInput /&gt;&#x27;</span>, <span class="hljs-function">() =&gt;</span> {
  <span class="hljs-keyword">const</span> renderComponent = <span class="hljs-function">(<span class="hljs-params">props: Props</span>) =&gt;</span> render(<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">OtpInput</span> {<span class="hljs-attr">...props</span>} /&gt;</span></span>);

  it(<span class="hljs-string">&#x27;should accept value &amp; valueLength props&#x27;</span>, <span class="hljs-function">() =&gt;</span> {});
});
</code></pre>
<p>Since we&#x27;ll be having multiple test cases for this component, creating a reusable function to render the component will reduce the code duplication. This will also make it easier if ever next time you have to rename your component. Since we can just change it within these lines and not in multiple separate lines.</p>
<p>Now, before we can render our component using the reusable function we need to provide the required props for it. This is where we use <code>faker</code> to generate random data for us. We need <code>digit</code> only so we can generate a random <code>number</code> then convert it into a <code>string</code> as <code>value</code> prop. It can be from <code>0</code> to <code>999999</code> which randomly generates a 1-digit code to a 6-digit code. For <code>valueLength</code>, we just use the length from the generated <code>value</code> prop.</p>
<p>How about <code>onChange</code> prop? We can actually just pass our own simple function but it would be better to create a mock function using <code>jest.fn()</code> which we allows us to capture the calls of it amongst other things you could do. To know more about mock functions and what you can do with it, you can read more <a target="_blank" rel="noopener noreferrer nofollow" href="https://jestjs.io/docs/mock-functions">here</a>.</p>
<div><ins class="adsbygoogle block max-w-[1200px] mx-auto adUnit_adunit__Qsm4B" data-ad-client="ca-pub-3632473845121107" data-ad-slot="3748487753" data-ad-format="fluid" data-ad-layout="in-article" data-full-width-responsive="true" data-testid="ad-unit"></ins></div>
<p>Here&#x27;s the following changes to the code:</p>
<pre><code class="hljs language-tsx">...
<span class="hljs-keyword">import</span> { faker } <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;@faker-js/faker&#x27;</span>;

describe(<span class="hljs-string">&#x27;&lt;OtpInput /&gt;&#x27;</span>, <span class="hljs-function">() =&gt;</span> {
  ...

  it(<span class="hljs-string">&#x27;should accept value &amp; valueLength props&#x27;</span>, <span class="hljs-function">() =&gt;</span> {
    <span class="hljs-keyword">const</span> value = faker.datatype.number({ <span class="hljs-attr">min</span>: <span class="hljs-number">0</span>, <span class="hljs-attr">max</span>: <span class="hljs-number">999999</span> }).toString();
    <span class="hljs-keyword">const</span> valueLength = value.length;

    renderComponent({
      value,
      valueLength,
      <span class="hljs-attr">onChange</span>: jest.fn(),
    });
  });
});
</code></pre>
<p>So after rendering the component, we need to do our checks afterwards. We basically can check that the number of input boxes is the same as the <code>valueLength</code>. To query all the input boxes, it is advisable to use <code>screen</code> methods from Testing Library, and in our case we can use <code>.queryAllByRole(&#x27;textbox&#x27;)</code>, which returns an array of elements that have <code>textbox</code> as a role. To learn more about queries in Testing Library, you can go <a target="_blank" rel="noopener noreferrer nofollow" href="https://testing-library.com/docs/queries/about">here</a>.</p>
<pre><code class="hljs language-tsx">...
<span class="hljs-keyword">import</span> { render, screen } <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;@testing-library/react&#x27;</span>;

describe(<span class="hljs-string">&#x27;&lt;OtpInput /&gt;&#x27;</span>, <span class="hljs-function">() =&gt;</span> {
  ...

  it(<span class="hljs-string">&#x27;should accept value &amp; valueLength props&#x27;</span>, <span class="hljs-function">() =&gt;</span> {
    ...

    renderComponent({
      value,
      valueLength,
      <span class="hljs-attr">onChange</span>: jest.fn(),
    });

    <span class="hljs-keyword">const</span> inputEls = screen.queryAllByRole(<span class="hljs-string">&#x27;textbox&#x27;</span>);
  });
});
</code></pre>
<div><ins class="adsbygoogle block max-w-[1200px] mx-auto adUnit_adunit__Qsm4B" data-ad-client="ca-pub-3632473845121107" data-ad-slot="3748487753" data-ad-format="fluid" data-ad-layout="in-article" data-full-width-responsive="true" data-testid="ad-unit"></ins></div>
<p>Okay, now we have an array of input elements. It is now possible to do the checks by executing one of Jest&#x27;s global functions called the <code>expect()</code> method and pass the element or elements returned by the query, and run what we call a matcher method <code>.toHaveLength()</code> which checks the length of the array is equal to the argument passed. This is one of the many custom matcher methods provided by the library called <a target="_blank" rel="noopener noreferrer nofollow" href="https://github.com/testing-library/jest-dom#custom-matchers">jest-dom</a> which are specific to the <a target="_blank" rel="noopener noreferrer nofollow" href="https://developer.mozilla.org/en-US/docs/Web/API/Document_Object_Model/Introduction">DOM</a>. While you can check this <a target="_blank" rel="noopener noreferrer nofollow" href="https://jestjs.io/docs/expect">documentation</a> for the more generic matcher methods. Here&#x27;s how the code looks like:</p>
<pre><code class="hljs language-tsx">...

describe(<span class="hljs-string">&#x27;&lt;OtpInput /&gt;&#x27;</span>, <span class="hljs-function">() =&gt;</span> {
  ...

  it(<span class="hljs-string">&#x27;should accept value &amp; valueLength props&#x27;</span>, <span class="hljs-function">() =&gt;</span> {
    ...

    renderComponent({
      value,
      valueLength,
      <span class="hljs-attr">onChange</span>: jest.fn(),
    });

    <span class="hljs-keyword">const</span> inputEls = screen.queryAllByRole(<span class="hljs-string">&#x27;textbox&#x27;</span>);

    expect(inputEls).toHaveLength(valueLength);
  });
});
</code></pre>
<p>And we just wrote our first test case! Save your changes and let&#x27;s verify if this test case did pass or not. In your terminal, run the following command:</p>
<pre><code class="hljs language-bash">yarn <span class="hljs-built_in">test</span> --coverage
</code></pre>
<p>The <code>--coverage</code> parameter will show you which how many percentage you have covered in each files of your project and/or if you have missed any line to test. Once the command ran successfully, the terminal should display something like this:</p>
<div class="lazyload-wrapper "><div class="lazyload-placeholder"></div></div>
<p>It did pass! So in the first test case, we can actually do another check to make it more robust and trustworthy. Remember we passed the <code>value</code> prop which contains a string of random digits? We can actually check that the input boxes contain each digit per box based on their position in the string. In this case, we can convert the generated <code>value</code> string into an array. Then loop through the input elements array which gives us access to the individual input element along with its index <code>idx</code>, then check from the <code>valueArray</code> array using the <code>idx</code> if it is the same value inside the input element. To check the input element value in the <code>expect()</code> method, we can use the custom matcher method <code>.toHaveValue()</code>. With this understanding, update the code with the following below:</p>
<pre><code class="hljs language-tsx">...

describe(<span class="hljs-string">&#x27;&lt;OtpInput /&gt;&#x27;</span>, <span class="hljs-function">() =&gt;</span> {
  ...

  it(<span class="hljs-string">&#x27;should accept value &amp; valueLength props&#x27;</span>, <span class="hljs-function">() =&gt;</span> {
    <span class="hljs-keyword">const</span> value = faker.datatype.number({ <span class="hljs-attr">min</span>: <span class="hljs-number">0</span>, <span class="hljs-attr">max</span>: <span class="hljs-number">999999</span> }).toString();
    <span class="hljs-keyword">const</span> valueArray = value.split(<span class="hljs-string">&#x27;&#x27;</span>);
    <span class="hljs-keyword">const</span> valueLength = value.length;

    ...

    expect(inputEls).toHaveLength(valueLength);

    inputEls.forEach(<span class="hljs-function">(<span class="hljs-params">inputEl, idx</span>) =&gt;</span> {
      expect(inputEl).toHaveValue(valueArray[idx]);
    });
  });
});
</code></pre>
<p>And, our first test should still passed. Let&#x27;s move on to the next test case.</p>
<div><ins class="adsbygoogle block max-w-[1200px] mx-auto adUnit_adunit__Qsm4B" data-ad-client="ca-pub-3632473845121107" data-ad-slot="3748487753" data-ad-format="fluid" data-ad-layout="in-article" data-full-width-responsive="true" data-testid="ad-unit"></ins></div>
<h2>Write tests to allow typing of digits</h2>
<p>Next test case would be to check when we type digits it should trigger the <code>onChange</code> function from the props and also focus on the next input element. If there&#x27;s no next input element, the focus should remain on the current element.</p>
<p>We can use the <code>fireEvent</code> method which is also from Testing Library to trigger DOM events in the test environment. To fire other DOM events, you can check out the <a target="_blank" rel="noopener noreferrer nofollow" href="https://testing-library.com/docs/dom-testing-library/api-events/">documentation</a>. First argument it accepts is the element you want the event to get fired to while optionally, you can pass a second argument to provide event data or details related to the event such as <code>target</code> object which is what we&#x27;ll be doing.</p>
<p>Here&#x27;s the code for the second test case:</p>
<pre><code class="hljs language-tsx"><span class="hljs-keyword">import</span> { fireEvent, render, screen } <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;@testing-library/react&#x27;</span>;
...

describe(<span class="hljs-string">&#x27;&lt;OtpInput /&gt;&#x27;</span>, <span class="hljs-function">() =&gt;</span> {
  ...

  it(<span class="hljs-string">&#x27;should allow typing of digits&#x27;</span>, <span class="hljs-function">() =&gt;</span> {
    <span class="hljs-keyword">const</span> valueLength = faker.datatype.number({ <span class="hljs-attr">min</span>: <span class="hljs-number">2</span>, <span class="hljs-attr">max</span>: <span class="hljs-number">6</span> }); <span class="hljs-comment">// random number from 2-6 (minimum 2 so it can focus on the next input)</span>
    <span class="hljs-keyword">const</span> onChange = jest.fn();

    renderComponent({
      valueLength,
      onChange,
      <span class="hljs-attr">value</span>: <span class="hljs-string">&#x27;&#x27;</span>, <span class="hljs-comment">// keep the value prop empty to trigger the change event</span>
    });

    <span class="hljs-keyword">const</span> inputEls = screen.queryAllByRole(<span class="hljs-string">&#x27;textbox&#x27;</span>);

    expect(inputEls).toHaveLength(valueLength);

    inputEls.forEach(<span class="hljs-function">(<span class="hljs-params">inputEl, idx</span>) =&gt;</span> {
      <span class="hljs-keyword">const</span> digit = faker.datatype.number({ <span class="hljs-attr">min</span>: <span class="hljs-number">0</span>, <span class="hljs-attr">max</span>: <span class="hljs-number">9</span> }).toString(); <span class="hljs-comment">// random number from 0-9, typing of digits is 1 by 1</span>

      <span class="hljs-comment">// trigger a change event</span>
      fireEvent.change(inputEl, {
        <span class="hljs-attr">target</span>: { <span class="hljs-attr">value</span>: digit }, <span class="hljs-comment">// pass it as the target.value in the event data</span>
      });

      <span class="hljs-comment">// custom matcher to check that &quot;onChange&quot; function was called with the same digit</span>
      expect(onChange).toBeCalledTimes(<span class="hljs-number">1</span>);
      expect(onChange).toBeCalledWith(digit);

      <span class="hljs-comment">// custom matcher to check that the focus is on the next input</span>
      <span class="hljs-comment">// OR</span>
      <span class="hljs-comment">// focus is on the current input if next input doesn&#x27;t exist</span>
      <span class="hljs-keyword">const</span> inputFocused = inputEls[idx + <span class="hljs-number">1</span>] || inputEl;

      expect(inputFocused).toHaveFocus();

      onChange.mockReset(); <span class="hljs-comment">// resets the call times for the next iteration of the loop</span>
    });
  });
});
</code></pre>
<p>I hope the comments helped in explaning the new codes.</p>
<p>Alright, save the changes above and check your terminal, the coverage now should look like this:</p>
<div class="lazyload-wrapper "><div class="lazyload-placeholder"></div></div>
<div><ins class="adsbygoogle block max-w-[1200px] mx-auto adUnit_adunit__Qsm4B" data-ad-client="ca-pub-3632473845121107" data-ad-slot="3748487753" data-ad-format="fluid" data-ad-layout="in-article" data-full-width-responsive="true" data-testid="ad-unit"></ins></div>
<h2>Write tests to not allow typing of non-digits</h2>
<p>Alright, now since we allow typing of digits in the input boxes, we should also check that we are not allowing typing of non-digits in the input boxes. The code for this test case would look similar to our previous test case with minor changes, here it is:</p>
<pre><code class="hljs language-tsx">...

describe(<span class="hljs-string">&#x27;&lt;OtpInput /&gt;&#x27;</span>, <span class="hljs-function">() =&gt;</span> {
  ...

  it(<span class="hljs-string">&#x27;should NOT allow typing of non-digits&#x27;</span>, <span class="hljs-function">() =&gt;</span> {
    <span class="hljs-keyword">const</span> valueLength = faker.datatype.number({ <span class="hljs-attr">min</span>: <span class="hljs-number">2</span>, <span class="hljs-attr">max</span>: <span class="hljs-number">6</span> });
    <span class="hljs-keyword">const</span> onChange = jest.fn();

    renderComponent({
      valueLength,
      onChange,
      <span class="hljs-attr">value</span>: <span class="hljs-string">&#x27;&#x27;</span>,
    });

    <span class="hljs-keyword">const</span> inputEls = screen.queryAllByRole(<span class="hljs-string">&#x27;textbox&#x27;</span>);

    expect(inputEls).toHaveLength(valueLength);

    inputEls.forEach(<span class="hljs-function">(<span class="hljs-params">inputEl</span>) =&gt;</span> {
      <span class="hljs-keyword">const</span> nonDigit = faker.random.alpha(<span class="hljs-number">1</span>);

      fireEvent.change(inputEl, {
        <span class="hljs-attr">target</span>: { <span class="hljs-attr">value</span>: nonDigit },
      });

      expect(onChange).not.toBeCalled();

      onChange.mockReset();
    });
  });
});
</code></pre>
<p>As you can see here, we generated a random alphabet character and use that as the value on the change event. <code>onChange</code> mock function shouldn&#x27;t be called because we are not supposed to do anything if the text is not a digit.</p>
<p>Save your changes and let&#x27;s verify this test case:</p>
<div class="lazyload-wrapper "><div class="lazyload-placeholder"></div></div>
<p>And the test case passes. Great!</p>
<div><ins class="adsbygoogle block max-w-[1200px] mx-auto adUnit_adunit__Qsm4B" data-ad-client="ca-pub-3632473845121107" data-ad-slot="3748487753" data-ad-format="fluid" data-ad-layout="in-article" data-full-width-responsive="true" data-testid="ad-unit"></ins></div>
<h2>Write tests to allow deleting of digits (focus on previous element)</h2>
<p>Now it&#x27;s time to write tests when we&#x27;re deleting digits from the input boxes. The logic there is that when we delete the digit from an input box, it will be replaced with a sapce <code>&#x27; &#x27;</code> to keep the position of the digits in other input boxes. Also if a key down event was triggered with the input value already empty, it should focus to the previous element. Let&#x27;s also ensure that there are values in the input boxes so that it can trigger the change event for deletion. This might be a little tough to write but here&#x27;s the code for this test case:</p>
<pre><code class="hljs language-tsx">...

describe(<span class="hljs-string">&#x27;&lt;OtpInput /&gt;&#x27;</span>, <span class="hljs-function">() =&gt;</span> {
  ...

  it(<span class="hljs-string">&#x27;should allow deleting of digits (focus on previous element)&#x27;</span>, <span class="hljs-function">() =&gt;</span> {
    <span class="hljs-keyword">const</span> value = faker.datatype.number({ <span class="hljs-attr">min</span>: <span class="hljs-number">10</span>, <span class="hljs-attr">max</span>: <span class="hljs-number">999999</span> }).toString(); <span class="hljs-comment">// minimum 2-digit so it can focus on the previous input</span>
    <span class="hljs-keyword">const</span> valueLength = value.length;
    <span class="hljs-keyword">const</span> lastIdx = valueLength - <span class="hljs-number">1</span>;
    <span class="hljs-keyword">const</span> onChange = jest.fn();

    renderComponent({
      value,
      valueLength,
      onChange,
    });

    <span class="hljs-keyword">const</span> inputEls = screen.queryAllByRole(<span class="hljs-string">&#x27;textbox&#x27;</span>);

    expect(inputEls).toHaveLength(valueLength);

    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> idx = lastIdx; idx &gt; -<span class="hljs-number">1</span>; idx--) { <span class="hljs-comment">// loop backwards to simulate the focus on the previous input</span>
      <span class="hljs-keyword">const</span> inputEl = inputEls[idx];
      <span class="hljs-keyword">const</span> target = { <span class="hljs-attr">value</span>: <span class="hljs-string">&#x27;&#x27;</span> };

      <span class="hljs-comment">// trigger both change and keydown event</span>
      fireEvent.change(inputEl, { target });
      fireEvent.keyDown(inputEl, {
        target,
        <span class="hljs-attr">key</span>: <span class="hljs-string">&#x27;Backspace&#x27;</span>,
      });

      <span class="hljs-keyword">const</span> valueArray = value.split(<span class="hljs-string">&#x27;&#x27;</span>);

      valueArray[idx] = <span class="hljs-string">&#x27; &#x27;</span>; <span class="hljs-comment">// the deleted digit is expected to be replaced with a space in the string</span>

      <span class="hljs-keyword">const</span> expectedValue = valueArray.join(<span class="hljs-string">&#x27;&#x27;</span>);

      expect(onChange).toBeCalledTimes(<span class="hljs-number">1</span>);
      expect(onChange).toBeCalledWith(expectedValue);

      <span class="hljs-comment">// custom matcher to check that the focus is on the previous input</span>
      <span class="hljs-comment">// OR</span>
      <span class="hljs-comment">// focus is on the current input if previous input doesn&#x27;t exist</span>
      <span class="hljs-keyword">const</span> inputFocused = inputEls[idx - <span class="hljs-number">1</span>] || inputEl;

      expect(inputFocused).toHaveFocus();

      onChange.mockReset();
    }
  });
});
</code></pre>
<p>Once the changes are saved, let&#x27;s check the terminal and see what&#x27;s displayed now:</p>
<div class="lazyload-wrapper "><div class="lazyload-placeholder"></div></div>
<p>Awesome, it still <code>PASS</code> and the uncovered lines are getting lesser. Let&#x27;s keep it going ~</p>
<div><ins class="adsbygoogle block max-w-[1200px] mx-auto adUnit_adunit__Qsm4B" data-ad-client="ca-pub-3632473845121107" data-ad-slot="3748487753" data-ad-format="fluid" data-ad-layout="in-article" data-full-width-responsive="true" data-testid="ad-unit"></ins></div>
<h2>Write tests to allow deleting of digits (do not focus on previous element)</h2>
<p>So this test case is kind of a duplicate of the above with minor changes to cover line <code>99</code> of <code>OtpInput.tsx</code>. When the deletion happens but the input element wasn&#x27;t previously empty, we should not focus on the previous element. Here&#x27;s the test case for that:</p>
<pre><code class="hljs language-tsx">...

describe(<span class="hljs-string">&#x27;&lt;OtpInput /&gt;&#x27;</span>, <span class="hljs-function">() =&gt;</span> {
  ...

  it(<span class="hljs-string">&#x27;should allow deleting of digits (do NOT focus on previous element)&#x27;</span>, <span class="hljs-function">() =&gt;</span> {
    <span class="hljs-keyword">const</span> value = faker.datatype.number({ <span class="hljs-attr">min</span>: <span class="hljs-number">10</span>, <span class="hljs-attr">max</span>: <span class="hljs-number">999999</span> }).toString();
    <span class="hljs-keyword">const</span> valueArray = value.split(<span class="hljs-string">&#x27;&#x27;</span>);
    <span class="hljs-keyword">const</span> valueLength = value.length;
    <span class="hljs-keyword">const</span> lastIdx = valueLength - <span class="hljs-number">1</span>;
    <span class="hljs-keyword">const</span> onChange = jest.fn();

    renderComponent({
      value,
      valueLength,
      onChange,
    });

    <span class="hljs-keyword">const</span> inputEls = screen.queryAllByRole(<span class="hljs-string">&#x27;textbox&#x27;</span>);

    expect(inputEls).toHaveLength(valueLength);

    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> idx = lastIdx; idx &gt; <span class="hljs-number">0</span>; idx--) { <span class="hljs-comment">// idx &gt; 0, because there&#x27;s no previous input in index 0</span>
      <span class="hljs-keyword">const</span> inputEl = inputEls[idx];

      fireEvent.keyDown(inputEl, {
        <span class="hljs-attr">key</span>: <span class="hljs-string">&#x27;Backspace&#x27;</span>,
        <span class="hljs-attr">target</span>: { <span class="hljs-attr">value</span>: valueArray[idx] },
      });

      <span class="hljs-keyword">const</span> prevInputEl = inputEls[idx - <span class="hljs-number">1</span>];

      expect(prevInputEl).not.toHaveFocus();

      onChange.mockReset();
    }
  });
});
</code></pre>
<p>Since our previous test case already checks the <code>onChange</code> logic during deletion, here we just have to check that the previous element was not in focus when we trigger a keydown event with a key of <code>Backspace</code> and the <code>target</code> during the event had a <code>value</code>.</p>
<p>Alright, once you save the changes, and check the terminal, line <code>99</code> is removed from the uncovered lines. Sweet!</p>
<div><ins class="adsbygoogle block max-w-[1200px] mx-auto adUnit_adunit__Qsm4B" data-ad-client="ca-pub-3632473845121107" data-ad-slot="3748487753" data-ad-format="fluid" data-ad-layout="in-article" data-full-width-responsive="true" data-testid="ad-unit"></ins></div>
<h2>Write tests to allow pasting of digits</h2>
<p>Okay, this test case should be easy enough for you to try out. I hope after learning how to write a couple of test cases above, you now have the knowledge and confidence to do this on your own. So first, before you start writing the code. Let&#x27;s understand what&#x27;s the logic for handling the paste event. So the paste event handling exists in the change event, it checks whether the <code>target.value</code> is a digit and also has the same length as the <code>valueLength</code>, we need to provide a digit that&#x27;s more than one in length so that it is considered a paste event and not just a normal typing of a single digit. Do keep the <code>value</code> passed in the props as empty since we are pasting the value in the change event. Since we allow pasting in any of the elements, you can either loop through all the input elements and trigger the change event, or you can even just choose a random input element to paste on which I think is good enough. Now after you triggered the change event with the <code>target.value</code> containing the copied digits. You should check that the <code>onChange</code> mock function was called with the same <code>digits</code> in the change event. As we are doing a <code>.blur()</code> in the paste event, it is good to check that the input element does not have the focus.</p>
<p>Alright, I gave you the hints, try it out yourself!</p>
<p>Once you&#x27;re done, compare it with the changes I did here:</p>
<pre><code class="hljs language-tsx">...

describe(<span class="hljs-string">&#x27;&lt;OtpInput /&gt;&#x27;</span>, <span class="hljs-function">() =&gt;</span> {
  ...

  it(<span class="hljs-string">&#x27;should allow pasting of digits (same length as valueLength)&#x27;</span>, <span class="hljs-function">() =&gt;</span> {
    <span class="hljs-keyword">const</span> value = faker.datatype.number({ <span class="hljs-attr">min</span>: <span class="hljs-number">10</span>, <span class="hljs-attr">max</span>: <span class="hljs-number">999999</span> }).toString(); <span class="hljs-comment">// minimum 2-digit so it is considered as a paste event</span>
    <span class="hljs-keyword">const</span> valueLength = value.length;
    <span class="hljs-keyword">const</span> onChange = jest.fn();

    renderComponent({
      valueLength,
      onChange,
      <span class="hljs-attr">value</span>: <span class="hljs-string">&#x27;&#x27;</span>, <span class="hljs-comment">// keep the value prop empty to trigger the change event for paste</span>
    });

    <span class="hljs-keyword">const</span> inputEls = screen.queryAllByRole(<span class="hljs-string">&#x27;textbox&#x27;</span>);

    <span class="hljs-comment">// get a random input element from the input elements to paste the digits on</span>
    <span class="hljs-keyword">const</span> randomIdx = faker.datatype.number({ <span class="hljs-attr">min</span>: <span class="hljs-number">0</span>, <span class="hljs-attr">max</span>: valueLength - <span class="hljs-number">1</span> });
    <span class="hljs-keyword">const</span> randomInputEl = inputEls[randomIdx];

    fireEvent.change(randomInputEl, { <span class="hljs-attr">target</span>: { value } });

    expect(onChange).toBeCalledTimes(<span class="hljs-number">1</span>);
    expect(onChange).toBeCalledWith(value);

    expect(randomInputEl).not.toHaveFocus();
  });
});
</code></pre>
<p>Okay if my changes are relatively the same as yours, then give yourself pat in the back!</p>
<p>The test coverage should look like this now:</p>
<div class="lazyload-wrapper "><div class="lazyload-placeholder"></div></div>
<p>Since we&#x27;re doing an <code>if</code> and <code>else if</code> conditions in the <code>inputOnChange</code> function in the <code>OtpInput.tsx</code>, line <code>72</code> will eventually be considered as uncovered lines because the <code>else</code> condition is not handled in our test cases yet. It may not show up now until you add the rest of the other test cases. So before that happens, let&#x27;s just cover that now with the following code:</p>
<pre><code class="hljs language-tsx"><span class="hljs-keyword">import</span> { fireEvent, render, screen } <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;@testing-library/react&#x27;</span>;
<span class="hljs-keyword">import</span> { faker } <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;@faker-js/faker&#x27;</span>;
<span class="hljs-keyword">import</span> OtpInput, { Props } <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;../OtpInput&#x27;</span>;

describe(<span class="hljs-string">&#x27;&lt;OtpInput /&gt;&#x27;</span>, <span class="hljs-function">() =&gt;</span> {
  ...

  it(<span class="hljs-string">&#x27;should NOT allow pasting of digits (less than valueLength)&#x27;</span>, <span class="hljs-function">() =&gt;</span> {
    <span class="hljs-keyword">const</span> value = faker.datatype.number({ <span class="hljs-attr">min</span>: <span class="hljs-number">10</span>, <span class="hljs-attr">max</span>: <span class="hljs-number">99999</span> }).toString(); <span class="hljs-comment">// random 2-5 digit code (less than &quot;valueLength&quot;)</span>
    <span class="hljs-keyword">const</span> valueLength = faker.datatype.number({ <span class="hljs-attr">min</span>: <span class="hljs-number">6</span>, <span class="hljs-attr">max</span>: <span class="hljs-number">10</span> }); <span class="hljs-comment">// random number from 6-10</span>
    <span class="hljs-keyword">const</span> onChange = jest.fn();

    renderComponent({
      valueLength,
      onChange,
      <span class="hljs-attr">value</span>: <span class="hljs-string">&#x27;&#x27;</span>,
    });

    <span class="hljs-keyword">const</span> inputEls = screen.queryAllByRole(<span class="hljs-string">&#x27;textbox&#x27;</span>);
    <span class="hljs-keyword">const</span> randomIdx = faker.datatype.number({ <span class="hljs-attr">min</span>: <span class="hljs-number">0</span>, <span class="hljs-attr">max</span>: valueLength - <span class="hljs-number">1</span> });
    <span class="hljs-keyword">const</span> randomInputEl = inputEls[randomIdx];

    fireEvent.change(randomInputEl, { <span class="hljs-attr">target</span>: { value } });

    expect(onChange).not.toBeCalled();
  });
});
</code></pre>
<p>Once you save the changes, this test case should pass as well.</p>
<div><ins class="adsbygoogle block max-w-[1200px] mx-auto adUnit_adunit__Qsm4B" data-ad-client="ca-pub-3632473845121107" data-ad-slot="3748487753" data-ad-format="fluid" data-ad-layout="in-article" data-full-width-responsive="true" data-testid="ad-unit"></ins></div>
<h2>Write tests for handling arrow keys</h2>
<p>And for our last test case, we should cover the keydown events with arrow keys. This was implemented to improve the accessibility of our input boxes. Just a recap, if we press the right or down arrow keys on the keyboard, the focus should be on the next input element. And if we press the left or up arrow keys on the keyboard, the focus should be on the previous input element. These are all handled by the keydown event handler.</p>
<p>Let&#x27;s first cover the right and down arrow keys. Here&#x27;s the test case for that:</p>
<pre><code class="hljs language-tsx">...

describe(<span class="hljs-string">&#x27;&lt;OtpInput /&gt;&#x27;</span>, <span class="hljs-function">() =&gt;</span> {
  ...

  it(<span class="hljs-string">&#x27;should focus to next element on right/down key&#x27;</span>, <span class="hljs-function">() =&gt;</span> {
    renderComponent({
      <span class="hljs-attr">value</span>: <span class="hljs-string">&#x27;&#x27;</span>,
      <span class="hljs-attr">valueLength</span>: <span class="hljs-number">3</span>,
      <span class="hljs-attr">onChange</span>: jest.fn(),
    });

    <span class="hljs-keyword">const</span> inputEls = screen.queryAllByRole(<span class="hljs-string">&#x27;textbox&#x27;</span>);
    <span class="hljs-keyword">const</span> firstInputEl = inputEls[<span class="hljs-number">0</span>];

    fireEvent.keyDown(firstInputEl, { <span class="hljs-attr">key</span>: <span class="hljs-string">&#x27;ArrowRight&#x27;</span> });

    <span class="hljs-keyword">const</span> secondInputEl = inputEls[<span class="hljs-number">1</span>];

    expect(secondInputEl).toHaveFocus();

    fireEvent.keyDown(secondInputEl, { <span class="hljs-attr">key</span>: <span class="hljs-string">&#x27;ArrowDown&#x27;</span> });

    <span class="hljs-keyword">const</span> thirdInputEl = inputEls[<span class="hljs-number">2</span>];

    expect(thirdInputEl).toHaveFocus();
  });
});
</code></pre>
<p>Here I did it manually so that it is easier to understand. First I triggered a keydown event with a key of <code>ArrowRight</code> to the first input element then checked that the second input element has the focus. Then I triggered another keydown event with a key of <code>ArrowDown</code> to the second input element then checked that the third input element has the focus.</p>
<p>Now by just merely changing the variables and the keys, you can cover the left and up arrow keys. Try it yourself!</p>
<div><ins class="adsbygoogle block max-w-[1200px] mx-auto adUnit_adunit__Qsm4B" data-ad-client="ca-pub-3632473845121107" data-ad-slot="3748487753" data-ad-format="fluid" data-ad-layout="in-article" data-full-width-responsive="true" data-testid="ad-unit"></ins></div>
<p>Once you&#x27;re done, check that the changes you did are about the same as mine:</p>
<pre><code class="hljs language-tsx">...

describe(<span class="hljs-string">&#x27;&lt;OtpInput /&gt;&#x27;</span>, <span class="hljs-function">() =&gt;</span> {
  ...

  it(<span class="hljs-string">&#x27;should focus to next element on left/up key&#x27;</span>, <span class="hljs-function">() =&gt;</span> {
    renderComponent({
      <span class="hljs-attr">value</span>: <span class="hljs-string">&#x27;&#x27;</span>,
      <span class="hljs-attr">valueLength</span>: <span class="hljs-number">3</span>,
      <span class="hljs-attr">onChange</span>: jest.fn(),
    });

    <span class="hljs-keyword">const</span> inputEls = screen.queryAllByRole(<span class="hljs-string">&#x27;textbox&#x27;</span>);
    <span class="hljs-keyword">const</span> thirdInputEl = inputEls[<span class="hljs-number">2</span>];

    fireEvent.keyDown(thirdInputEl, { <span class="hljs-attr">key</span>: <span class="hljs-string">&#x27;ArrowLeft&#x27;</span> });

    <span class="hljs-keyword">const</span> secondInputEl = inputEls[<span class="hljs-number">1</span>];

    expect(secondInputEl).toHaveFocus();

    fireEvent.keyDown(secondInputEl, { <span class="hljs-attr">key</span>: <span class="hljs-string">&#x27;ArrowUp&#x27;</span> });

    <span class="hljs-keyword">const</span> firstInputEl = inputEls[<span class="hljs-number">0</span>];

    expect(firstInputEl).toHaveFocus();
  });
});
</code></pre>
<p>Don&#x27;t forget to save your changes before you check the terminal:</p>
<div class="lazyload-wrapper "><div class="lazyload-placeholder"></div></div>
<p>Wow, all green which means we have 100% test coverage. That&#x27;s very satisfying to see, ain&#x27;t it?</p>
<p>We have completed writing tests for our React OTP Input component. Well done for reaching to this point ~</p>
<p>That&#x27;s it! You&#x27;ve just built your own OTP input in React and TypeScript and also learned how to write tests for it using Jest and Testing Library. I hope you&#x27;ve learned a lot from this post, especially if you&#x27;re new to TypeScript and Jest. The OTP input we have just built is reusable and provides great user experience while keeping in mind the best practices when implementing an OTP input. You can customize the <code>valueLength</code> prop to meet your requirements, be it a 4-PIN code, 5-digit pass code or 6-digit one-time code. As I mentioned earlier, there&#x27;s tons of OTP input boxes I&#x27;ve seen out there but some of them don&#x27;t give a great user experience like this, so please share to your network, colleagues or anyone you think might find this post helpful and let&#x27;s make OTP input boxes great again!</p>
<p>In case you need the final code of the OTP input component as a reference, here&#x27;s the <a target="_blank" rel="noopener noreferrer nofollow" href="https://github.com/dominicarrojado/react-typescript-otp-input">GitHub repository</a>.</p>
<p>I&#x27;ll be writing more of posts about &quot;building your own components in React and TypeScript with tests&quot; so stay stuned and come back again to my blog to check out what&#x27;s new.</p>
<p>Cheers ~</p>
<h2>Online references</h2>
<ul>
<li><a target="_blank" rel="noopener noreferrer nofollow" href="https://developer.mozilla.org/en-US/">MDN Web Docs</a></li>
<li><a target="_blank" rel="noopener noreferrer nofollow" href="https://web.dev/sms-otp-form/">SMS OTP form best practices</a></li>
</ul></article><div class="w-11/12 max-w-screen-3xl mx-auto lg:w-5/6"><p class="mt-16 text-gray-400">Found an issue with this post?<!-- --> <a target="_blank" rel="noopener noreferrer nofollow" href="https://github.com/dominicarrojado/dominicarrojado.github.io/issues">Report it here</a>.</p><div class="mt-24 flex justify-between items-center"><a class="group relative pr-2" href="/posts/how-to-create-your-own-otp-input-in-react-and-typescript-with-tests-part-1/"><div class=""><div class="font-normal transition-colors duration-300 group-hover:text-black motion-reduce:transition-none dark:group-hover:text-white">How to create your own OTP input in React and TypeScript with tests (Part 1)</div><small class="text-gray-400 transition-colors duration-300 group-hover:text-black motion-reduce:transition-none dark:group-hover:text-white">Previous Post</small></div><svg viewBox="0 0 320 512" role="img" class="absolute top-0 bottom-0 m-auto shrink-0 w-2 h-2 text-black opacity-30 dark:text-white transform transition-transform-opacity duration-300 group-hover:opacity-100 motion-reduce:transition-none sm:w-2.5 sm:h-2.5 md:w-3 md:h-3 xl:w-3.5 xl:h-3.5 -left-5 sm:-left-7 xl:-left-8 group-hover:-translate-x-1.5"><path fill="currentColor" d="M34.52 239.03L228.87 44.69c9.37-9.37 24.57-9.37 33.94 0l22.67 22.67c9.36 9.36 9.37 24.52.04 33.9L131.49 256l154.02 154.75c9.34 9.38 9.32 24.54-.04 33.9l-22.67 22.67c-9.37 9.37-24.57 9.37-33.94 0L34.52 272.97c-9.37-9.37-9.37-24.57 0-33.94z"></path></svg></a><div></div><a class="group relative pl-2" href="/posts/local-development-setup-for-nextjs-typescript-and-tailwindcss-projects/"><div class="text-right"><div class="font-normal transition-colors duration-300 group-hover:text-black motion-reduce:transition-none dark:group-hover:text-white">Local development setup for Next.js projects with TypeScript and TailwindCSS</div><small class="text-gray-400 transition-colors duration-300 group-hover:text-black motion-reduce:transition-none dark:group-hover:text-white">Next Post</small></div><svg viewBox="0 0 320 512" role="img" class="absolute top-0 bottom-0 m-auto shrink-0 w-2 h-2 text-black opacity-30 dark:text-white transform transition-transform-opacity duration-300 group-hover:opacity-100 motion-reduce:transition-none sm:w-2.5 sm:h-2.5 md:w-3 md:h-3 xl:w-3.5 xl:h-3.5 -right-5 sm:-right-7 xl:-right-8 group-hover:translate-x-1.5"><path fill="currentColor" d="M285.476 272.971L91.132 467.314c-9.373 9.373-24.569 9.373-33.941 0l-22.667-22.667c-9.357-9.357-9.375-24.522-.04-33.901L188.505 256 34.484 101.255c-9.335-9.379-9.317-24.544.04-33.901l22.667-22.667c9.373-9.373 24.569-9.373 33.941 0L285.475 239.03c9.373 9.372 9.373 24.568.001 33.941z"></path></svg></a></div><div class="mt-16 text-center"><a class="group inline-flex items-center font-normal select-none dark:hover:text-white transition-colors duration-300 hover:text-black group-hover:text-black motion-reduce:transition-none" href="/posts/">See Latest Posts<svg viewBox="0 0 320 512" role="img" class="inline-block w-2 h-2 ml-2 text-black opacity-30 dark:text-white transform transition duration-300 group-hover:translate-x-1.5 group-hover:opacity-100 motion-reduce:transition-none sm:w-2.5 sm:h-2.5 sm:ml-2.5 md:w-3 md:h-3 md:ml-3 xl:w-3.5 xl:h-3.5"><path fill="currentColor" d="M285.476 272.971L91.132 467.314c-9.373 9.373-24.569 9.373-33.941 0l-22.667-22.667c-9.357-9.357-9.375-24.522-.04-33.901L188.505 256 34.484 101.255c-9.335-9.379-9.317-24.544.04-33.901l22.667-22.667c9.373-9.373 24.569-9.373 33.941 0L285.475 239.03c9.373 9.372 9.373 24.568.001 33.941z"></path></svg></a></div></div><div class="w-11/12 max-w-screen-3xl -mb-8 mx-auto pt-8 sm:-mb-10 sm:pt-10 md:-mb-12 md:pt-12 lg:w-5/6"><ins class="adsbygoogle block max-w-[1200px] mx-auto adUnit_adunit__Qsm4B" data-ad-client="ca-pub-3632473845121107" data-ad-slot="6892691691" data-ad-format="auto" data-full-width-responsive="true" data-testid="ad-unit"></ins></div></section><footer class="py-20 px-6 bg-gray-100 dark:bg-gray-850 overflow-hidden lg:overflow-auto transition-opacity duration-1000 delay-1750 motion-reduce:transition-none opacity-0" data-testid="footer"><ul class="relative text-center overflow-hidden transition-height duration-1000 motion-reduce:transition-none sm:text-lg xl:text-xl" style="height:0"><li class="absolute top-0 left-0 w-full transition-opacity duration-1000 motion-reduce:transition-none"><blockquote>“<!-- -->If there is no struggle, there is no progress.<!-- -->”</blockquote><p class="mt-1 sm:mt-2">— <!-- -->Frederick Douglass</p></li><li class="absolute top-0 left-0 w-full transition-opacity duration-1000 motion-reduce:transition-none opacity-0 pointer-events-none"><blockquote>“<!-- -->It&#x27;s okay to figure out murder mysteries, but you shouldn&#x27;t need to figure out code. You should be able to read it.<!-- -->”</blockquote><p class="mt-1 sm:mt-2">— <!-- -->Steve McConnell</p></li><li class="absolute top-0 left-0 w-full transition-opacity duration-1000 motion-reduce:transition-none opacity-0 pointer-events-none"><blockquote>“<!-- -->If you can&#x27;t explain it simply, you don&#x27;t understand it well enough.<!-- -->”</blockquote><p class="mt-1 sm:mt-2">— <!-- -->Albert Einstein</p></li><li class="absolute top-0 left-0 w-full transition-opacity duration-1000 motion-reduce:transition-none opacity-0 pointer-events-none"><blockquote>“<!-- -->The secret of getting ahead is getting started.<!-- -->”</blockquote><p class="mt-1 sm:mt-2">— <!-- -->Mark Twain</p></li></ul><ul class="max-w-full mt-10 flex flex-wrap justify-center lg:hidden"><li class="flex lg:transform lg:transition lg:ease-in-out lg:duration-500 motion-reduce:lg:transition-none lg:opacity-0 lg:translate-y-full" style="transition-delay:2050ms"><a target="_blank" rel="noopener noreferrer nofollow" tabindex="0" aria-describedby="tooltip-donate" href="https://www.paypal.com/paypalme/DominicArrojado" class="group inline-flex p-3 cursor-pointer sm:p-4" aria-label="Show your support and donate!"><svg viewBox="0 0 512 512" role="img" class="w-7 h-7 text-gray-400 dark:text-gray-300 transition-colors group-hover:text-gray-500 motion-reduce:transition-none dark:group-hover:text-white sm:w-8 sm:h-8 xl:w-9 xl:h-9"><path fill="currentColor" d="M256 416c114.9 0 208-93.1 208-208S370.9 0 256 0 48 93.1 48 208s93.1 208 208 208zM233.8 97.4V80.6c0-9.2 7.4-16.6 16.6-16.6h11.1c9.2 0 16.6 7.4 16.6 16.6v17c15.5.8 30.5 6.1 43 15.4 5.6 4.1 6.2 12.3 1.2 17.1L306 145.6c-3.8 3.7-9.5 3.8-14 1-5.4-3.4-11.4-5.1-17.8-5.1h-38.9c-9 0-16.3 8.2-16.3 18.3 0 8.2 5 15.5 12.1 17.6l62.3 18.7c25.7 7.7 43.7 32.4 43.7 60.1 0 34-26.4 61.5-59.1 62.4v16.8c0 9.2-7.4 16.6-16.6 16.6h-11.1c-9.2 0-16.6-7.4-16.6-16.6v-17c-15.5-.8-30.5-6.1-43-15.4-5.6-4.1-6.2-12.3-1.2-17.1l16.3-15.5c3.8-3.7 9.5-3.8 14-1 5.4 3.4 11.4 5.1 17.8 5.1h38.9c9 0 16.3-8.2 16.3-18.3 0-8.2-5-15.5-12.1-17.6l-62.3-18.7c-25.7-7.7-43.7-32.4-43.7-60.1.1-34 26.4-61.5 59.1-62.4zM480 352h-32.5c-19.6 26-44.6 47.7-73 64h63.8c5.3 0 9.6 3.6 9.6 8v16c0 4.4-4.3 8-9.6 8H73.6c-5.3 0-9.6-3.6-9.6-8v-16c0-4.4 4.3-8 9.6-8h63.8c-28.4-16.3-53.3-38-73-64H32c-17.7 0-32 14.3-32 32v96c0 17.7 14.3 32 32 32h448c17.7 0 32-14.3 32-32v-96c0-17.7-14.3-32-32-32z"></path></svg></a></li><li class="flex lg:transform lg:transition lg:ease-in-out lg:duration-500 motion-reduce:lg:transition-none lg:opacity-0 lg:translate-y-full" style="transition-delay:2200ms"><a target="_blank" rel="noopener noreferrer nofollow" tabindex="0" aria-describedby="tooltip-youtube" href="https://www.youtube.com/channel/UCWwV__qrzg5BYCSwO91Xhxg/videos?view=0&amp;sort=dd" class="group inline-flex p-3 cursor-pointer sm:p-4" aria-label="Watch my tech videos!"><svg viewBox="0 0 576 512" role="img" class="w-7 h-7 text-gray-400 dark:text-gray-300 transition-colors group-hover:text-gray-500 motion-reduce:transition-none dark:group-hover:text-white sm:w-8 sm:h-8 xl:w-9 xl:h-9"><path fill="currentColor" d="M549.655 124.083c-6.281-23.65-24.787-42.276-48.284-48.597C458.781 64 288 64 288 64S117.22 64 74.629 75.486c-23.497 6.322-42.003 24.947-48.284 48.597-11.412 42.867-11.412 132.305-11.412 132.305s0 89.438 11.412 132.305c6.281 23.65 24.787 41.5 48.284 47.821C117.22 448 288 448 288 448s170.78 0 213.371-11.486c23.497-6.321 42.003-24.171 48.284-47.821 11.412-42.867 11.412-132.305 11.412-132.305s0-89.438-11.412-132.305zm-317.51 213.508V175.185l142.739 81.205-142.739 81.201z"></path></svg></a></li><li class="flex lg:transform lg:transition lg:ease-in-out lg:duration-500 motion-reduce:lg:transition-none lg:opacity-0 lg:translate-y-full" style="transition-delay:2350ms"><a target="_blank" rel="noopener noreferrer nofollow" tabindex="0" aria-describedby="tooltip-linkedin" href="https://www.linkedin.com/in/dominic-arrojado-75ba03a9/" class="group inline-flex p-3 cursor-pointer sm:p-4" aria-label="Let&#x27;s connect on LinkedIn!"><svg viewBox="0 0 448 512" role="img" class="w-7 h-7 text-gray-400 dark:text-gray-300 transition-colors group-hover:text-gray-500 motion-reduce:transition-none dark:group-hover:text-white sm:w-8 sm:h-8 xl:w-9 xl:h-9"><path fill="currentColor" d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9V416z"></path></svg></a></li><li class="flex lg:transform lg:transition lg:ease-in-out lg:duration-500 motion-reduce:lg:transition-none lg:opacity-0 lg:translate-y-full" style="transition-delay:2500ms"><a target="_blank" rel="noopener noreferrer nofollow" tabindex="0" aria-describedby="tooltip-github" href="https://github.com/dominicarrojado/" class="group inline-flex p-3 cursor-pointer sm:p-4" aria-label="Follow me on GitHub!"><svg viewBox="0 0 496 512" role="img" class="w-7 h-7 text-gray-400 dark:text-gray-300 transition-colors group-hover:text-gray-500 motion-reduce:transition-none dark:group-hover:text-white sm:w-8 sm:h-8 xl:w-9 xl:h-9"><path fill="currentColor" d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"></path></svg></a></li><li class="flex lg:transform lg:transition lg:ease-in-out lg:duration-500 motion-reduce:lg:transition-none lg:opacity-0 lg:translate-y-full" style="transition-delay:2650ms"><a target="_blank" rel="noopener noreferrer nofollow" tabindex="0" aria-describedby="tooltip-email" href="mailto:dominicarrojado@gmail.com" class="group inline-flex p-3 cursor-pointer sm:p-4" aria-label="Email me!"><svg viewBox="0 0 512 512" role="img" class="w-7 h-7 text-gray-400 dark:text-gray-300 transition-colors group-hover:text-gray-500 motion-reduce:transition-none dark:group-hover:text-white sm:w-8 sm:h-8 xl:w-9 xl:h-9"><path fill="currentColor" d="M502.3 190.8c3.9-3.1 9.7-.2 9.7 4.7V400c0 26.5-21.5 48-48 48H48c-26.5 0-48-21.5-48-48V195.6c0-5 5.7-7.8 9.7-4.7 22.4 17.4 52.1 39.5 154.1 113.6 21.1 15.4 56.7 47.8 92.2 47.6 35.7.3 72-32.8 92.3-47.6 102-74.1 131.6-96.3 154-113.7zM256 320c23.2.4 56.6-29.2 73.4-41.4 132.7-96.3 142.8-104.7 173.4-128.7 5.8-4.5 9.2-11.5 9.2-18.9v-19c0-26.5-21.5-48-48-48H48C21.5 64 0 85.5 0 112v19c0 7.4 3.4 14.3 9.2 18.9 30.6 23.9 40.7 32.4 173.4 128.7 16.8 12.2 50.2 41.8 73.4 41.4z"></path></svg></a></li></ul><p class="mt-4 text-gray-400 text-sm text-center sm:text-base lg:mt-10 xl:text-lg"><span class="font-normal">©<!-- -->2022<!-- --> Dominic Arrojado</span> <span class="block mt-1 sm:hidden"></span><span class="hidden sm:inline">·</span> <a href="/privacy-policy/">Privacy Policy</a> <!-- -->·<!-- --> <a href="/disclaimer/">Disclaimer</a></p></footer></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"postData":{"id":"how-to-create-your-own-otp-input-in-react-and-typescript-with-tests-part-2","content":"\n## Introduction\n\nThis is a continuation from [Part 1](/posts/how-to-create-your-own-otp-input-in-react-and-typescript-with-tests-part-1).\n\n## Prerequisites\n\nTo get started with testing, first install the package below:\n\n```bash\nyarn add @faker-js/faker\n```\n\n[`@faker-js/faker`](https://github.com/faker-js/faker) helps us generate massive amounts of fake (but realistic) data for testing. Check out the guide for `faker` [here](https://fakerjs.dev/guide/).\n\n---\n\n## Write tests for props\n\nFor test files, I like to separate them in a folder so that it's less cluttered when viewing the main files. Create a new folder named `__tests__` under the `src/components`. This is where we will put the test files for the components under `src/components` folder.\n\nSince we are writing tests for `OtpInput` component, create a file under `src/components/__tests__` and name it `OtpInput.test.tsx`. This is a common naming convention for test files, make sure it matches the name of the component you are testing.\n\nThen let's add in the structure of the test:\n\n```tsx\nimport OtpInput, { Props } from '../OtpInput';\n\ndescribe('\u003cOtpInput /\u003e', () =\u003e {});\n```\n\nAside from importing the component that we will test, we also imported the type `Props`. You'll get to know why we did that later on.\n\n`describe` is one of Jest's global functions, so with the setup of Create React App, we don't need to specifically import these global functions in our code, we can just directly use them. `describe` creates a block that groups together several related tests. So ideally the description should be describing what we are testing, so in this case I used the component name. Feel free to rename it according to your preference.\n\nNext we can add a test case inside the `describe` block:\n\n```tsx\nimport OtpInput, { Props } from '../OtpInput';\n\ndescribe('\u003cOtpInput /\u003e', () =\u003e {\n  it('should accept value \u0026 valueLength props', () =\u003e {});\n});\n```\n\nThe `it` (or `test`) method is another global function by Jest that runs a test. This is where we can have different test cases. Let's start to populate our first test case. First you want to do is to create a reusable function `renderComponent` inside the `describe` block, it should accepts the props of our component as an argument and calls the `render()` method from Testing Library to render our component with the passed props in a test environment.\n\n```tsx\nimport { render } from '@testing-library/react';\nimport OtpInput, { Props } from '../OtpInput';\n\ndescribe('\u003cOtpInput /\u003e', () =\u003e {\n  const renderComponent = (props: Props) =\u003e render(\u003cOtpInput {...props} /\u003e);\n\n  it('should accept value \u0026 valueLength props', () =\u003e {});\n});\n```\n\nSince we'll be having multiple test cases for this component, creating a reusable function to render the component will reduce the code duplication. This will also make it easier if ever next time you have to rename your component. Since we can just change it within these lines and not in multiple separate lines.\n\nNow, before we can render our component using the reusable function we need to provide the required props for it. This is where we use `faker` to generate random data for us. We need `digit` only so we can generate a random `number` then convert it into a `string` as `value` prop. It can be from `0` to `999999` which randomly generates a 1-digit code to a 6-digit code. For `valueLength`, we just use the length from the generated `value` prop.\n\nHow about `onChange` prop? We can actually just pass our own simple function but it would be better to create a mock function using `jest.fn()` which we allows us to capture the calls of it amongst other things you could do. To know more about mock functions and what you can do with it, you can read more [here](https://jestjs.io/docs/mock-functions).\n\n---\n\nHere's the following changes to the code:\n\n```tsx\n...\nimport { faker } from '@faker-js/faker';\n\ndescribe('\u003cOtpInput /\u003e', () =\u003e {\n  ...\n\n  it('should accept value \u0026 valueLength props', () =\u003e {\n    const value = faker.datatype.number({ min: 0, max: 999999 }).toString();\n    const valueLength = value.length;\n\n    renderComponent({\n      value,\n      valueLength,\n      onChange: jest.fn(),\n    });\n  });\n});\n```\n\nSo after rendering the component, we need to do our checks afterwards. We basically can check that the number of input boxes is the same as the `valueLength`. To query all the input boxes, it is advisable to use `screen` methods from Testing Library, and in our case we can use `.queryAllByRole('textbox')`, which returns an array of elements that have `textbox` as a role. To learn more about queries in Testing Library, you can go [here](https://testing-library.com/docs/queries/about).\n\n```tsx\n...\nimport { render, screen } from '@testing-library/react';\n\ndescribe('\u003cOtpInput /\u003e', () =\u003e {\n  ...\n\n  it('should accept value \u0026 valueLength props', () =\u003e {\n    ...\n\n    renderComponent({\n      value,\n      valueLength,\n      onChange: jest.fn(),\n    });\n\n    const inputEls = screen.queryAllByRole('textbox');\n  });\n});\n```\n\n---\n\nOkay, now we have an array of input elements. It is now possible to do the checks by executing one of Jest's global functions called the `expect()` method and pass the element or elements returned by the query, and run what we call a matcher method `.toHaveLength()` which checks the length of the array is equal to the argument passed. This is one of the many custom matcher methods provided by the library called [jest-dom](https://github.com/testing-library/jest-dom#custom-matchers) which are specific to the [DOM](https://developer.mozilla.org/en-US/docs/Web/API/Document_Object_Model/Introduction). While you can check this [documentation](https://jestjs.io/docs/expect) for the more generic matcher methods. Here's how the code looks like:\n\n```tsx\n...\n\ndescribe('\u003cOtpInput /\u003e', () =\u003e {\n  ...\n\n  it('should accept value \u0026 valueLength props', () =\u003e {\n    ...\n\n    renderComponent({\n      value,\n      valueLength,\n      onChange: jest.fn(),\n    });\n\n    const inputEls = screen.queryAllByRole('textbox');\n\n    expect(inputEls).toHaveLength(valueLength);\n  });\n});\n```\n\nAnd we just wrote our first test case! Save your changes and let's verify if this test case did pass or not. In your terminal, run the following command:\n\n```bash\nyarn test --coverage\n```\n\nThe `--coverage` parameter will show you which how many percentage you have covered in each files of your project and/or if you have missed any line to test. Once the command ran successfully, the terminal should display something like this:\n\n![Screenshot of React OTP Input incomplete test coverage](/images/posts/how-to-create-your-own-otp-input-in-react-and-typescript-with-tests/test-coverage-incomplete-1.png)\n\nIt did pass! So in the first test case, we can actually do another check to make it more robust and trustworthy. Remember we passed the `value` prop which contains a string of random digits? We can actually check that the input boxes contain each digit per box based on their position in the string. In this case, we can convert the generated `value` string into an array. Then loop through the input elements array which gives us access to the individual input element along with its index `idx`, then check from the `valueArray` array using the `idx` if it is the same value inside the input element. To check the input element value in the `expect()` method, we can use the custom matcher method `.toHaveValue()`. With this understanding, update the code with the following below:\n\n```tsx\n...\n\ndescribe('\u003cOtpInput /\u003e', () =\u003e {\n  ...\n\n  it('should accept value \u0026 valueLength props', () =\u003e {\n    const value = faker.datatype.number({ min: 0, max: 999999 }).toString();\n    const valueArray = value.split('');\n    const valueLength = value.length;\n\n    ...\n\n    expect(inputEls).toHaveLength(valueLength);\n\n    inputEls.forEach((inputEl, idx) =\u003e {\n      expect(inputEl).toHaveValue(valueArray[idx]);\n    });\n  });\n});\n```\n\nAnd, our first test should still passed. Let's move on to the next test case.\n\n---\n\n## Write tests to allow typing of digits\n\nNext test case would be to check when we type digits it should trigger the `onChange` function from the props and also focus on the next input element. If there's no next input element, the focus should remain on the current element.\n\nWe can use the `fireEvent` method which is also from Testing Library to trigger DOM events in the test environment. To fire other DOM events, you can check out the [documentation](https://testing-library.com/docs/dom-testing-library/api-events/). First argument it accepts is the element you want the event to get fired to while optionally, you can pass a second argument to provide event data or details related to the event such as `target` object which is what we'll be doing.\n\nHere's the code for the second test case:\n\n```tsx\nimport { fireEvent, render, screen } from '@testing-library/react';\n...\n\ndescribe('\u003cOtpInput /\u003e', () =\u003e {\n  ...\n\n  it('should allow typing of digits', () =\u003e {\n    const valueLength = faker.datatype.number({ min: 2, max: 6 }); // random number from 2-6 (minimum 2 so it can focus on the next input)\n    const onChange = jest.fn();\n\n    renderComponent({\n      valueLength,\n      onChange,\n      value: '', // keep the value prop empty to trigger the change event\n    });\n\n    const inputEls = screen.queryAllByRole('textbox');\n\n    expect(inputEls).toHaveLength(valueLength);\n\n    inputEls.forEach((inputEl, idx) =\u003e {\n      const digit = faker.datatype.number({ min: 0, max: 9 }).toString(); // random number from 0-9, typing of digits is 1 by 1\n\n      // trigger a change event\n      fireEvent.change(inputEl, {\n        target: { value: digit }, // pass it as the target.value in the event data\n      });\n\n      // custom matcher to check that \"onChange\" function was called with the same digit\n      expect(onChange).toBeCalledTimes(1);\n      expect(onChange).toBeCalledWith(digit);\n\n      // custom matcher to check that the focus is on the next input\n      // OR\n      // focus is on the current input if next input doesn't exist\n      const inputFocused = inputEls[idx + 1] || inputEl;\n\n      expect(inputFocused).toHaveFocus();\n\n      onChange.mockReset(); // resets the call times for the next iteration of the loop\n    });\n  });\n});\n```\n\nI hope the comments helped in explaning the new codes.\n\nAlright, save the changes above and check your terminal, the coverage now should look like this:\n\n![Screenshot of React OTP Input incomplete test coverage](/images/posts/how-to-create-your-own-otp-input-in-react-and-typescript-with-tests/test-coverage-incomplete-2.png)\n\n---\n\n## Write tests to not allow typing of non-digits\n\nAlright, now since we allow typing of digits in the input boxes, we should also check that we are not allowing typing of non-digits in the input boxes. The code for this test case would look similar to our previous test case with minor changes, here it is:\n\n```tsx\n...\n\ndescribe('\u003cOtpInput /\u003e', () =\u003e {\n  ...\n\n  it('should NOT allow typing of non-digits', () =\u003e {\n    const valueLength = faker.datatype.number({ min: 2, max: 6 });\n    const onChange = jest.fn();\n\n    renderComponent({\n      valueLength,\n      onChange,\n      value: '',\n    });\n\n    const inputEls = screen.queryAllByRole('textbox');\n\n    expect(inputEls).toHaveLength(valueLength);\n\n    inputEls.forEach((inputEl) =\u003e {\n      const nonDigit = faker.random.alpha(1);\n\n      fireEvent.change(inputEl, {\n        target: { value: nonDigit },\n      });\n\n      expect(onChange).not.toBeCalled();\n\n      onChange.mockReset();\n    });\n  });\n});\n```\n\nAs you can see here, we generated a random alphabet character and use that as the value on the change event. `onChange` mock function shouldn't be called because we are not supposed to do anything if the text is not a digit.\n\nSave your changes and let's verify this test case:\n\n![Screenshot of React OTP Input incomplete test coverage](/images/posts/how-to-create-your-own-otp-input-in-react-and-typescript-with-tests/test-coverage-incomplete-3.png)\n\nAnd the test case passes. Great!\n\n---\n\n## Write tests to allow deleting of digits (focus on previous element)\n\nNow it's time to write tests when we're deleting digits from the input boxes. The logic there is that when we delete the digit from an input box, it will be replaced with a sapce `' '` to keep the position of the digits in other input boxes. Also if a key down event was triggered with the input value already empty, it should focus to the previous element. Let's also ensure that there are values in the input boxes so that it can trigger the change event for deletion. This might be a little tough to write but here's the code for this test case:\n\n```tsx\n...\n\ndescribe('\u003cOtpInput /\u003e', () =\u003e {\n  ...\n\n  it('should allow deleting of digits (focus on previous element)', () =\u003e {\n    const value = faker.datatype.number({ min: 10, max: 999999 }).toString(); // minimum 2-digit so it can focus on the previous input\n    const valueLength = value.length;\n    const lastIdx = valueLength - 1;\n    const onChange = jest.fn();\n\n    renderComponent({\n      value,\n      valueLength,\n      onChange,\n    });\n\n    const inputEls = screen.queryAllByRole('textbox');\n\n    expect(inputEls).toHaveLength(valueLength);\n\n    for (let idx = lastIdx; idx \u003e -1; idx--) { // loop backwards to simulate the focus on the previous input\n      const inputEl = inputEls[idx];\n      const target = { value: '' };\n\n      // trigger both change and keydown event\n      fireEvent.change(inputEl, { target });\n      fireEvent.keyDown(inputEl, {\n        target,\n        key: 'Backspace',\n      });\n\n      const valueArray = value.split('');\n\n      valueArray[idx] = ' '; // the deleted digit is expected to be replaced with a space in the string\n\n      const expectedValue = valueArray.join('');\n\n      expect(onChange).toBeCalledTimes(1);\n      expect(onChange).toBeCalledWith(expectedValue);\n\n      // custom matcher to check that the focus is on the previous input\n      // OR\n      // focus is on the current input if previous input doesn't exist\n      const inputFocused = inputEls[idx - 1] || inputEl;\n\n      expect(inputFocused).toHaveFocus();\n\n      onChange.mockReset();\n    }\n  });\n});\n```\n\nOnce the changes are saved, let's check the terminal and see what's displayed now:\n\n![Screenshot of React OTP Input incomplete test coverage](/images/posts/how-to-create-your-own-otp-input-in-react-and-typescript-with-tests/test-coverage-incomplete-4.png)\n\nAwesome, it still `PASS` and the uncovered lines are getting lesser. Let's keep it going ~\n\n---\n\n## Write tests to allow deleting of digits (do not focus on previous element)\n\nSo this test case is kind of a duplicate of the above with minor changes to cover line `99` of `OtpInput.tsx`. When the deletion happens but the input element wasn't previously empty, we should not focus on the previous element. Here's the test case for that:\n\n```tsx\n...\n\ndescribe('\u003cOtpInput /\u003e', () =\u003e {\n  ...\n\n  it('should allow deleting of digits (do NOT focus on previous element)', () =\u003e {\n    const value = faker.datatype.number({ min: 10, max: 999999 }).toString();\n    const valueArray = value.split('');\n    const valueLength = value.length;\n    const lastIdx = valueLength - 1;\n    const onChange = jest.fn();\n\n    renderComponent({\n      value,\n      valueLength,\n      onChange,\n    });\n\n    const inputEls = screen.queryAllByRole('textbox');\n\n    expect(inputEls).toHaveLength(valueLength);\n\n    for (let idx = lastIdx; idx \u003e 0; idx--) { // idx \u003e 0, because there's no previous input in index 0\n      const inputEl = inputEls[idx];\n\n      fireEvent.keyDown(inputEl, {\n        key: 'Backspace',\n        target: { value: valueArray[idx] },\n      });\n\n      const prevInputEl = inputEls[idx - 1];\n\n      expect(prevInputEl).not.toHaveFocus();\n\n      onChange.mockReset();\n    }\n  });\n});\n```\n\nSince our previous test case already checks the `onChange` logic during deletion, here we just have to check that the previous element was not in focus when we trigger a keydown event with a key of `Backspace` and the `target` during the event had a `value`.\n\nAlright, once you save the changes, and check the terminal, line `99` is removed from the uncovered lines. Sweet!\n\n---\n\n## Write tests to allow pasting of digits\n\nOkay, this test case should be easy enough for you to try out. I hope after learning how to write a couple of test cases above, you now have the knowledge and confidence to do this on your own. So first, before you start writing the code. Let's understand what's the logic for handling the paste event. So the paste event handling exists in the change event, it checks whether the `target.value` is a digit and also has the same length as the `valueLength`, we need to provide a digit that's more than one in length so that it is considered a paste event and not just a normal typing of a single digit. Do keep the `value` passed in the props as empty since we are pasting the value in the change event. Since we allow pasting in any of the elements, you can either loop through all the input elements and trigger the change event, or you can even just choose a random input element to paste on which I think is good enough. Now after you triggered the change event with the `target.value` containing the copied digits. You should check that the `onChange` mock function was called with the same `digits` in the change event. As we are doing a `.blur()` in the paste event, it is good to check that the input element does not have the focus.\n\nAlright, I gave you the hints, try it out yourself!\n\nOnce you're done, compare it with the changes I did here:\n\n```tsx\n...\n\ndescribe('\u003cOtpInput /\u003e', () =\u003e {\n  ...\n\n  it('should allow pasting of digits (same length as valueLength)', () =\u003e {\n    const value = faker.datatype.number({ min: 10, max: 999999 }).toString(); // minimum 2-digit so it is considered as a paste event\n    const valueLength = value.length;\n    const onChange = jest.fn();\n\n    renderComponent({\n      valueLength,\n      onChange,\n      value: '', // keep the value prop empty to trigger the change event for paste\n    });\n\n    const inputEls = screen.queryAllByRole('textbox');\n\n    // get a random input element from the input elements to paste the digits on\n    const randomIdx = faker.datatype.number({ min: 0, max: valueLength - 1 });\n    const randomInputEl = inputEls[randomIdx];\n\n    fireEvent.change(randomInputEl, { target: { value } });\n\n    expect(onChange).toBeCalledTimes(1);\n    expect(onChange).toBeCalledWith(value);\n\n    expect(randomInputEl).not.toHaveFocus();\n  });\n});\n```\n\nOkay if my changes are relatively the same as yours, then give yourself pat in the back!\n\nThe test coverage should look like this now:\n\n![Screenshot of React OTP Input incomplete test coverage](/images/posts/how-to-create-your-own-otp-input-in-react-and-typescript-with-tests/test-coverage-incomplete-5.png)\n\nSince we're doing an `if` and `else if` conditions in the `inputOnChange` function in the `OtpInput.tsx`, line `72` will eventually be considered as uncovered lines because the `else` condition is not handled in our test cases yet. It may not show up now until you add the rest of the other test cases. So before that happens, let's just cover that now with the following code:\n\n```tsx\nimport { fireEvent, render, screen } from '@testing-library/react';\nimport { faker } from '@faker-js/faker';\nimport OtpInput, { Props } from '../OtpInput';\n\ndescribe('\u003cOtpInput /\u003e', () =\u003e {\n  ...\n\n  it('should NOT allow pasting of digits (less than valueLength)', () =\u003e {\n    const value = faker.datatype.number({ min: 10, max: 99999 }).toString(); // random 2-5 digit code (less than \"valueLength\")\n    const valueLength = faker.datatype.number({ min: 6, max: 10 }); // random number from 6-10\n    const onChange = jest.fn();\n\n    renderComponent({\n      valueLength,\n      onChange,\n      value: '',\n    });\n\n    const inputEls = screen.queryAllByRole('textbox');\n    const randomIdx = faker.datatype.number({ min: 0, max: valueLength - 1 });\n    const randomInputEl = inputEls[randomIdx];\n\n    fireEvent.change(randomInputEl, { target: { value } });\n\n    expect(onChange).not.toBeCalled();\n  });\n});\n```\n\nOnce you save the changes, this test case should pass as well.\n\n---\n\n## Write tests for handling arrow keys\n\nAnd for our last test case, we should cover the keydown events with arrow keys. This was implemented to improve the accessibility of our input boxes. Just a recap, if we press the right or down arrow keys on the keyboard, the focus should be on the next input element. And if we press the left or up arrow keys on the keyboard, the focus should be on the previous input element. These are all handled by the keydown event handler.\n\nLet's first cover the right and down arrow keys. Here's the test case for that:\n\n```tsx\n...\n\ndescribe('\u003cOtpInput /\u003e', () =\u003e {\n  ...\n\n  it('should focus to next element on right/down key', () =\u003e {\n    renderComponent({\n      value: '',\n      valueLength: 3,\n      onChange: jest.fn(),\n    });\n\n    const inputEls = screen.queryAllByRole('textbox');\n    const firstInputEl = inputEls[0];\n\n    fireEvent.keyDown(firstInputEl, { key: 'ArrowRight' });\n\n    const secondInputEl = inputEls[1];\n\n    expect(secondInputEl).toHaveFocus();\n\n    fireEvent.keyDown(secondInputEl, { key: 'ArrowDown' });\n\n    const thirdInputEl = inputEls[2];\n\n    expect(thirdInputEl).toHaveFocus();\n  });\n});\n```\n\nHere I did it manually so that it is easier to understand. First I triggered a keydown event with a key of `ArrowRight` to the first input element then checked that the second input element has the focus. Then I triggered another keydown event with a key of `ArrowDown` to the second input element then checked that the third input element has the focus.\n\nNow by just merely changing the variables and the keys, you can cover the left and up arrow keys. Try it yourself!\n\n---\n\nOnce you're done, check that the changes you did are about the same as mine:\n\n```tsx\n...\n\ndescribe('\u003cOtpInput /\u003e', () =\u003e {\n  ...\n\n  it('should focus to next element on left/up key', () =\u003e {\n    renderComponent({\n      value: '',\n      valueLength: 3,\n      onChange: jest.fn(),\n    });\n\n    const inputEls = screen.queryAllByRole('textbox');\n    const thirdInputEl = inputEls[2];\n\n    fireEvent.keyDown(thirdInputEl, { key: 'ArrowLeft' });\n\n    const secondInputEl = inputEls[1];\n\n    expect(secondInputEl).toHaveFocus();\n\n    fireEvent.keyDown(secondInputEl, { key: 'ArrowUp' });\n\n    const firstInputEl = inputEls[0];\n\n    expect(firstInputEl).toHaveFocus();\n  });\n});\n```\n\nDon't forget to save your changes before you check the terminal:\n\n![Screenshot of React OTP Input complete test coverage](/images/posts/how-to-create-your-own-otp-input-in-react-and-typescript-with-tests/test-coverage-complete.png)\n\nWow, all green which means we have 100% test coverage. That's very satisfying to see, ain't it?\n\nWe have completed writing tests for our React OTP Input component. Well done for reaching to this point ~\n\nThat's it! You've just built your own OTP input in React and TypeScript and also learned how to write tests for it using Jest and Testing Library. I hope you've learned a lot from this post, especially if you're new to TypeScript and Jest. The OTP input we have just built is reusable and provides great user experience while keeping in mind the best practices when implementing an OTP input. You can customize the `valueLength` prop to meet your requirements, be it a 4-PIN code, 5-digit pass code or 6-digit one-time code. As I mentioned earlier, there's tons of OTP input boxes I've seen out there but some of them don't give a great user experience like this, so please share to your network, colleagues or anyone you think might find this post helpful and let's make OTP input boxes great again!\n\nIn case you need the final code of the OTP input component as a reference, here's the [GitHub repository](https://github.com/dominicarrojado/react-typescript-otp-input).\n\nI'll be writing more of posts about \"building your own components in React and TypeScript with tests\" so stay stuned and come back again to my blog to check out what's new.\n\nCheers ~\n\n## Online references\n\n- [MDN Web Docs](https://developer.mozilla.org/en-US/)\n- [SMS OTP form best practices](https://web.dev/sms-otp-form/)\n","previousPost":{"id":"how-to-create-your-own-otp-input-in-react-and-typescript-with-tests-part-1","title":"How to create your own OTP input in React and TypeScript with tests (Part 1)","date":"2022-06-16","excerpt":"Learn how to build a modern OTP input component in a reactive and reusable way","category":"technology","videoUrl":"https://youtu.be/Qpo4gUfv2Fs"},"nextPost":{"id":"local-development-setup-for-nextjs-typescript-and-tailwindcss-projects","title":"Local development setup for Next.js projects with TypeScript and TailwindCSS","date":"2022-07-20","excerpt":"A quick way to get started with the React framework for production","category":"technology","videoUrl":"https://youtu.be/2Zb93oc0068"},"title":"How to create your own OTP input in React and TypeScript with tests (Part 2)","date":"2022-06-16","excerpt":"Learn how to build a modern OTP input component in a reactive and reusable way","category":"technology","videoUrl":"https://youtu.be/s6MFjcCen2A"}},"__N_SSG":true},"page":"/posts/[id]","query":{"id":"how-to-create-your-own-otp-input-in-react-and-typescript-with-tests-part-2"},"buildId":"w_lcLaTtnDc8K5YgyDF9D","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>
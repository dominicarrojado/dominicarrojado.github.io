<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1"/><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#2c2c34"/><link rel="icon" href="https://dominicarrojado.com/favicon.ico"/><link rel="manifest" href="https://dominicarrojado.com/manifest.json"/><meta name="twitter:card" content="summary_large_image"/><meta property="og:image" content="https://dominicarrojado.com/images/pages/guides-tips-and-tricks-to-web-development.png"/><meta property="og:image:alt" content="Dominic Arrojado | Guides, Tips and Tricks to Web Development"/><meta property="og:image:type" content="image/png"/><meta property="og:image:width" content="2400"/><meta property="og:image:height" content="1254"/><meta property="og:site_name" content="Dominic Arrojado"/><link rel="preload" href="/fonts/Roboto-Light.woff2" as="font" type="font/woff2" crossorigin="anonymous"/><link rel="preload" href="/fonts/Roboto-Light.woff" as="font" type="font/woff" crossorigin="anonymous"/><link rel="preload" href="/fonts/Roboto-LightItalic.woff2" as="font" type="font/woff2" crossorigin="anonymous"/><link rel="preload" href="/fonts/Roboto-LightItalic.woff" as="font" type="font/woff" crossorigin="anonymous"/><link rel="preload" href="/fonts/Roboto-Regular.woff2" as="font" type="font/woff2" crossorigin="anonymous"/><link rel="preload" href="/fonts/Roboto-Regular.woff" as="font" type="font/woff" crossorigin="anonymous"/><link rel="preload" href="/fonts/Roboto-Italic.woff2" as="font" type="font/woff2" crossorigin="anonymous"/><link rel="preload" href="/fonts/Roboto-Italic.woff" as="font" type="font/woff" crossorigin="anonymous"/><link rel="preload" href="/fonts/Roboto-Medium.woff2" as="font" type="font/woff2" crossorigin="anonymous"/><link rel="preload" href="/fonts/Roboto-Medium.woff" as="font" type="font/woff" crossorigin="anonymous"/><link rel="preload" href="/fonts/Roboto-MediumItalic.woff2" as="font" type="font/woff2" crossorigin="anonymous"/><link rel="preload" href="/fonts/Roboto-MediumItalic.woff" as="font" type="font/woff" crossorigin="anonymous"/><link rel="preload" href="/fonts/Roboto-Bold.woff2" as="font" type="font/woff2" crossorigin="anonymous"/><link rel="preload" href="/fonts/Roboto-Bold.woff" as="font" type="font/woff" crossorigin="anonymous"/><link rel="preload" href="/fonts/Roboto-BoldItalic.woff2" as="font" type="font/woff2" crossorigin="anonymous"/><link rel="preload" href="/fonts/Roboto-BoldItalic.woff" as="font" type="font/woff" crossorigin="anonymous"/><title>How to integrate with a REST API using React Hooks and TypeScript with tests | Dominic Arrojado</title><meta name="robots" content="index,follow"/><meta name="description" content="Learn how to integrate with a REST API in a reactive and reusable way"/><meta property="og:title" content="How to integrate with a REST API using React Hooks and TypeScript with tests | Dominic Arrojado"/><meta property="og:description" content="Learn how to integrate with a REST API in a reactive and reusable way"/><meta property="og:url" content="https://dominicarrojado.com/posts/how-to-integrate-with-a-rest-api-using-react-hooks-and-typescript-with-tests/"/><meta property="og:type" content="article"/><meta property="article:published_time" content="2021-12-04T14:00:00Z"/><meta property="article:modified_time" content="2021-12-04T14:00:00Z"/><meta property="article:author" content="https://dominicarrojado.com/about/"/><link rel="canonical" href="https://dominicarrojado.com/posts/how-to-integrate-with-a-rest-api-using-react-hooks-and-typescript-with-tests/"/><meta name="next-head-count" content="39"/><link rel="preload" href="/_next/static/css/03c4e31a73cf7137.css" as="style"/><link rel="stylesheet" href="/_next/static/css/03c4e31a73cf7137.css" data-n-g=""/><link rel="preload" href="/_next/static/css/82d01f71dc75279c.css" as="style"/><link rel="stylesheet" href="/_next/static/css/82d01f71dc75279c.css" data-n-p=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-5cd94c89d3acac5f.js"></script><script src="/_next/static/chunks/webpack-bdd3a163f0ab51a5.js" defer=""></script><script src="/_next/static/chunks/framework-433e73989db4e225.js" defer=""></script><script src="/_next/static/chunks/main-c51b0b3c89045435.js" defer=""></script><script src="/_next/static/chunks/pages/_app-6689ebc7d6e214ee.js" defer=""></script><script src="/_next/static/chunks/216-1077b041778ead2e.js" defer=""></script><script src="/_next/static/chunks/466-2aafae0e90314603.js" defer=""></script><script src="/_next/static/chunks/pages/posts/%5Bid%5D-101bdca647312681.js" defer=""></script><script src="/_next/static/UQD9M7dkedoXqXN1-gQoy/_buildManifest.js" defer=""></script><script src="/_next/static/UQD9M7dkedoXqXN1-gQoy/_ssgManifest.js" defer=""></script><script src="/_next/static/UQD9M7dkedoXqXN1-gQoy/_middlewareManifest.js" defer=""></script></head><body><div id="__next" data-reactroot=""><noscript>
            <iframe
              src="https://www.googletagmanager.com/ns.html?id=GTM-TSMLTPT"
              height="0"
              width="0"
              style="display: none; visibility: hidden"
            ></iframe>
          </noscript><div tabindex="-1" class="h-full outline-none"><header><a href="#main" tabindex="0" class="absolute -top-96 -left-96 w-px h-px text-center text-white overflow-hidden -z-50 focus:top-4 focus:inset-x-0 focus:m-auto focus:w-44 focus:h-auto focus:z-50 focus:sm:w-52 focus:xl:w-56">Skip to main content</a><a class="group fixed top-3.5 left-3.5 z-50 flex shadow-3xl border border-white bg-gray-750 bg-opacity-90 p-1.5 transform transition ease-in-out duration-500 hover:shadow-md hover:bg-opacity-100 motion-reduce:transition-none sm:top-4 sm:left-4 md:top-6 md:left-8 md:border-2 xl:left-9 xl:p-2 delay-700 opacity-0 -translate-y-full" aria-label="Dominic Arrojado logo" href="/"><svg viewBox="0 0 25750 29700" role="img" class="w-7 h-7 text-white transition-colors duration-300 sm:w-8 sm:h-8 md:w-10 md:h-10 xl:w-11 xl:h-11"><path fill="currentColor" d="M4850 19266H1025V2039l4600-129c2511 0 4500 735 5970 2206 1470 1470 2206 3423 2206 5854 0 6199-2985 9296-8951 9296zM4086 4719v11751c494 48 1025 72 1599 72 1543 0 2752-558 3624-1679s1310-2688 1310-4705c0-3684-1712-5524-5135-5524-329 0-795 28-1398 85zm17656 21711l-1437-3969h-6721l974-2655h4730l-2242-6854 1518-4167 7010 17645zM17826 435h3307L10351 29313H7044l4243-11322c1982-1513 2973-4055 2973-7627 0-171-4-340-11-506l3577-9423z"></path></svg></a><div class="fixed flex items-end top-3 right-1 z-50 sm:right-2 md:top-6 md:right-4 xl:top-7" data-testid="header-buttons"><button type="button" aria-expanded="false" aria-controls="dialog-menu" aria-haspopup="dialog" class="group flex items-center flex-col min-w-12 pt-3 pb-2 px-2 outline-none md:min-w-15.5 md:px-3 xl:min-w-18.5"><div class="w-6 h-0.5 bg-gray-400 rounded dark:bg-gray-300 transform transition group-hover:bg-gray-500 group-focus-visible:bg-gray-500 motion-reduce:transition-none dark:group-hover:bg-white dark:group-focus-visible:bg-white md:w-7 md:h-1 xl:w-8 duration-1000 opacity-0 translate-x-1/2" style="transition-delay:500ms" data-testid="menu-stack"></div><div class="w-6 h-0.5 bg-gray-400 rounded dark:bg-gray-300 transform transition group-hover:bg-gray-500 group-focus-visible:bg-gray-500 motion-reduce:transition-none dark:group-hover:bg-white dark:group-focus-visible:bg-white md:w-7 md:h-1 xl:w-8 mt-1.5 duration-1000 opacity-0 -translate-x-1/2" style="transition-delay:650ms" data-testid="menu-stack"></div><div class="w-6 h-0.5 bg-gray-400 rounded dark:bg-gray-300 transform transition group-hover:bg-gray-500 group-focus-visible:bg-gray-500 motion-reduce:transition-none dark:group-hover:bg-white dark:group-focus-visible:bg-white md:w-7 md:h-1 xl:w-8 mt-1.5 duration-1000 opacity-0 translate-x-1/2" style="transition-delay:800ms" data-testid="menu-stack"></div><div class="mt-1.5 text-gray-400 text-3xs font-normal uppercase select-none dark:text-gray-300 transform transition-transform-opacity-color group-hover:text-gray-500 motion-reduce:transition-none dark:group-hover:text-gray-100 md:mt-2 md:text-2xs xl:text-xs duration-700 delay-1000 opacity-0 -translate-y-3">Menu</div></button></div><div class="hidden lg:block lg:fixed lg:bottom-3 lg:right-7 lg:z-40" data-testid="header-social"><ul class="max-w-full mt-10 flex flex-wrap justify-center lg:mt-0"><li class="flex lg:transform lg:transition lg:ease-in-out lg:duration-500 motion-reduce:lg:transition-none lg:opacity-0 lg:translate-y-full" style="transition-delay:2050ms"><a target="_blank" rel="noopener noreferrer nofollow" tabindex="0" aria-describedby="tooltip-donate" href="https://www.paypal.com/paypalme/DominicArrojado" class="group inline-flex p-3 cursor-pointer sm:p-4" aria-label="Show your support and donate!"><svg viewBox="0 0 512 512" role="img" class="w-7 h-7 text-gray-400 dark:text-gray-300 transition-colors group-hover:text-gray-500 motion-reduce:transition-none dark:group-hover:text-white sm:w-8 sm:h-8 xl:w-9 xl:h-9"><path fill="currentColor" d="M256 416c114.9 0 208-93.1 208-208S370.9 0 256 0 48 93.1 48 208s93.1 208 208 208zM233.8 97.4V80.6c0-9.2 7.4-16.6 16.6-16.6h11.1c9.2 0 16.6 7.4 16.6 16.6v17c15.5.8 30.5 6.1 43 15.4 5.6 4.1 6.2 12.3 1.2 17.1L306 145.6c-3.8 3.7-9.5 3.8-14 1-5.4-3.4-11.4-5.1-17.8-5.1h-38.9c-9 0-16.3 8.2-16.3 18.3 0 8.2 5 15.5 12.1 17.6l62.3 18.7c25.7 7.7 43.7 32.4 43.7 60.1 0 34-26.4 61.5-59.1 62.4v16.8c0 9.2-7.4 16.6-16.6 16.6h-11.1c-9.2 0-16.6-7.4-16.6-16.6v-17c-15.5-.8-30.5-6.1-43-15.4-5.6-4.1-6.2-12.3-1.2-17.1l16.3-15.5c3.8-3.7 9.5-3.8 14-1 5.4 3.4 11.4 5.1 17.8 5.1h38.9c9 0 16.3-8.2 16.3-18.3 0-8.2-5-15.5-12.1-17.6l-62.3-18.7c-25.7-7.7-43.7-32.4-43.7-60.1.1-34 26.4-61.5 59.1-62.4zM480 352h-32.5c-19.6 26-44.6 47.7-73 64h63.8c5.3 0 9.6 3.6 9.6 8v16c0 4.4-4.3 8-9.6 8H73.6c-5.3 0-9.6-3.6-9.6-8v-16c0-4.4 4.3-8 9.6-8h63.8c-28.4-16.3-53.3-38-73-64H32c-17.7 0-32 14.3-32 32v96c0 17.7 14.3 32 32 32h448c17.7 0 32-14.3 32-32v-96c0-17.7-14.3-32-32-32z"></path></svg></a></li><li class="flex lg:transform lg:transition lg:ease-in-out lg:duration-500 motion-reduce:lg:transition-none lg:opacity-0 lg:translate-y-full" style="transition-delay:2200ms"><a target="_blank" rel="noopener noreferrer nofollow" tabindex="0" aria-describedby="tooltip-youtube" href="https://www.youtube.com/channel/UCWwV__qrzg5BYCSwO91Xhxg/videos?view=0&amp;sort=dd" class="group inline-flex p-3 cursor-pointer sm:p-4" aria-label="Watch my tech videos!"><svg viewBox="0 0 576 512" role="img" class="w-7 h-7 text-gray-400 dark:text-gray-300 transition-colors group-hover:text-gray-500 motion-reduce:transition-none dark:group-hover:text-white sm:w-8 sm:h-8 xl:w-9 xl:h-9"><path fill="currentColor" d="M549.655 124.083c-6.281-23.65-24.787-42.276-48.284-48.597C458.781 64 288 64 288 64S117.22 64 74.629 75.486c-23.497 6.322-42.003 24.947-48.284 48.597-11.412 42.867-11.412 132.305-11.412 132.305s0 89.438 11.412 132.305c6.281 23.65 24.787 41.5 48.284 47.821C117.22 448 288 448 288 448s170.78 0 213.371-11.486c23.497-6.321 42.003-24.171 48.284-47.821 11.412-42.867 11.412-132.305 11.412-132.305s0-89.438-11.412-132.305zm-317.51 213.508V175.185l142.739 81.205-142.739 81.201z"></path></svg></a></li><li class="flex lg:transform lg:transition lg:ease-in-out lg:duration-500 motion-reduce:lg:transition-none lg:opacity-0 lg:translate-y-full" style="transition-delay:2350ms"><a target="_blank" rel="noopener noreferrer nofollow" tabindex="0" aria-describedby="tooltip-linkedin" href="https://www.linkedin.com/in/dominic-arrojado-75ba03a9/" class="group inline-flex p-3 cursor-pointer sm:p-4" aria-label="Let&#x27;s connect on LinkedIn!"><svg viewBox="0 0 448 512" role="img" class="w-7 h-7 text-gray-400 dark:text-gray-300 transition-colors group-hover:text-gray-500 motion-reduce:transition-none dark:group-hover:text-white sm:w-8 sm:h-8 xl:w-9 xl:h-9"><path fill="currentColor" d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9V416z"></path></svg></a></li><li class="flex lg:transform lg:transition lg:ease-in-out lg:duration-500 motion-reduce:lg:transition-none lg:opacity-0 lg:translate-y-full" style="transition-delay:2500ms"><a target="_blank" rel="noopener noreferrer nofollow" tabindex="0" aria-describedby="tooltip-github" href="https://github.com/dominicarrojado/" class="group inline-flex p-3 cursor-pointer sm:p-4" aria-label="Follow me on GitHub!"><svg viewBox="0 0 496 512" role="img" class="w-7 h-7 text-gray-400 dark:text-gray-300 transition-colors group-hover:text-gray-500 motion-reduce:transition-none dark:group-hover:text-white sm:w-8 sm:h-8 xl:w-9 xl:h-9"><path fill="currentColor" d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"></path></svg></a></li><li class="flex lg:transform lg:transition lg:ease-in-out lg:duration-500 motion-reduce:lg:transition-none lg:opacity-0 lg:translate-y-full" style="transition-delay:2650ms"><a target="_blank" rel="noopener noreferrer nofollow" tabindex="0" aria-describedby="tooltip-email" href="mailto:dominicarrojado@gmail.com" class="group inline-flex p-3 cursor-pointer sm:p-4" aria-label="Email me!"><svg viewBox="0 0 512 512" role="img" class="w-7 h-7 text-gray-400 dark:text-gray-300 transition-colors group-hover:text-gray-500 motion-reduce:transition-none dark:group-hover:text-white sm:w-8 sm:h-8 xl:w-9 xl:h-9"><path fill="currentColor" d="M502.3 190.8c3.9-3.1 9.7-.2 9.7 4.7V400c0 26.5-21.5 48-48 48H48c-26.5 0-48-21.5-48-48V195.6c0-5 5.7-7.8 9.7-4.7 22.4 17.4 52.1 39.5 154.1 113.6 21.1 15.4 56.7 47.8 92.2 47.6 35.7.3 72-32.8 92.3-47.6 102-74.1 131.6-96.3 154-113.7zM256 320c23.2.4 56.6-29.2 73.4-41.4 132.7-96.3 142.8-104.7 173.4-128.7 5.8-4.5 9.2-11.5 9.2-18.9v-19c0-26.5-21.5-48-48-48H48C21.5 64 0 85.5 0 112v19c0 7.4 3.4 14.3 9.2 18.9 30.6 23.9 40.7 32.4 173.4 128.7 16.8 12.2 50.2 41.8 73.4 41.4z"></path></svg></a></li></ul></div></header><div id="main"></div><section class="relative flex flex-col justify-center bg-gray-550 py-28 px-6 text-center overflow-hidden dark:bg-gray-750 transform transition-transform ease-in-out duration-500 motion-reduce:transition-none sm:px-20 lg:px-32 min-h-96 -translate-y-full" data-testid="container"><div class="absolute top-0 left-0 w-full h-full bg-repeat bg-center invert-[.1] dark:invert-0 motion-safe:animate-slide transition-opacity duration-1250 delay-500 motion-reduce:transition-none opacity-0" style="background-image:url(&#x27;/images/bg/pattern.png&#x27;)" data-testid="background"></div><div class="overflow-hidden py-2" style="opacity:1"><h1 class="text-3xl font-bold text-white leading-tight transform transition duration-1000 delay-500 motion-reduce:transition-none sm:text-4xl md:text-5xl lg:text-6xl xl:text-7xl opacity-0 translate-y-full">How to integrate with a REST API using React Hooks and TypeScript with tests</h1></div><div class="overflow-hidden" style="opacity:1"><p class="font-light text-white transform transition duration-1000 delay-1000 motion-reduce:transition-none xl:text-2xl opacity-0 translate-y-full">Learn how to integrate with a REST API in a reactive and reusable way</p></div></section><section class="pt-16 pb-20 px-6 sm:pt-20 sm:pb-24 sm:px-8 md:pt-24 md:pb-28 lg:px-10 xl:pt-28 xl:pb-32 transform transition-transform-opacity duration-1000 motion-reduce:transition-none delay-1500 opacity-0 translate-y-10" data-testid="section"><div class="w-11/12 max-w-screen-3xl -mt-8 mx-auto pb-8 sm:-mt-10 sm:pb-10 md:-mt-12 md:pb-12 lg:w-5/6"><ins class="adsbygoogle block max-w-[1200px] mx-auto adUnit_adunit__Qsm4B" data-ad-client="ca-pub-3632473845121107" data-ad-slot="4984498713" data-ad-format="auto" data-full-width-responsive="true" data-testid="ad-unit"></ins></div><div class="flex justify-between items-center w-11/12 max-w-screen-3xl mx-auto lg:w-5/6"><div class="mr-4 text-sm text-gray-400 sm:text-base xl:text-lg">Last Updated: <time dateTime="2021-12-04">December 4, 2021</time></div><div class="rounded py-0.5 px-1.5 bg-gray-200 text-2xs capitalize dark:bg-gray-600 md:py-1 md:px-2 md:text-xs xl:text-sm">technology</div></div><div class="w-11/12 max-w-screen-3xl mt-4 mx-auto lg:w-5/6"><a class="group inline-flex items-center font-normal select-none dark:hover:text-white transition-colors duration-300 hover:text-black group-hover:text-black motion-reduce:transition-none" target="_blank" rel="noopener noreferrer nofollow" href="https://youtu.be/LkumZ2Z7bbs"><svg viewBox="0 0 576 512" role="img" class="w-6 h-6 mr-2 text-gray-400 transition-colors duration-300 group-hover:text-red motion-reduce:transition-none dark:group-hover:text-white sm:w-7 sm:h-7 sm:mr-3 xl:w-8 xl:h-8"><path fill="currentColor" d="M549.655 124.083c-6.281-23.65-24.787-42.276-48.284-48.597C458.781 64 288 64 288 64S117.22 64 74.629 75.486c-23.497 6.322-42.003 24.947-48.284 48.597-11.412 42.867-11.412 132.305-11.412 132.305s0 89.438 11.412 132.305c6.281 23.65 24.787 41.5 48.284 47.821C117.22 448 288 448 288 448s170.78 0 213.371-11.486c23.497-6.321 42.003-24.171 48.284-47.821 11.412-42.867 11.412-132.305 11.412-132.305s0-89.438-11.412-132.305zm-317.51 213.508V175.185l142.739 81.205-142.739 81.201z"></path></svg> <!-- -->Watch it on YouTube<svg viewBox="0 0 320 512" role="img" class="inline-block w-2 h-2 ml-2 text-black opacity-30 dark:text-white transform transition duration-300 group-hover:translate-x-1.5 group-hover:opacity-100 motion-reduce:transition-none sm:w-2.5 sm:h-2.5 sm:ml-2.5 md:w-3 md:h-3 md:ml-3 xl:w-3.5 xl:h-3.5"><path fill="currentColor" d="M285.476 272.971L91.132 467.314c-9.373 9.373-24.569 9.373-33.941 0l-22.667-22.667c-9.357-9.357-9.375-24.522-.04-33.901L188.505 256 34.484 101.255c-9.335-9.379-9.317-24.544.04-33.901l22.667-22.667c9.373-9.373 24.569-9.373 33.941 0L285.475 239.03c9.373 9.372 9.373 24.568.001 33.941z"></path></svg></a></div><article class="w-11/12 max-w-screen-3xl mx-auto prose dark:prose-dark sm:prose-lg lg:w-5/6 xl:prose-xl mt-8 sm:mt-10 xl:mt-14" data-clarity-region="article" data-testid="content"><h2>Introduction</h2>
<p>One of my favorite features that <a target="_blank" rel="noopener noreferrer nofollow" href="https://reactjs.org/">React</a> introduced is <a target="_blank" rel="noopener noreferrer nofollow" href="https://reactjs.org/docs/hooks-intro.html">React Hooks</a>. They let you use state and other React features without writing a class. I personally feel that it is cleaner, more readable and much easier to build React components and features with it. Using React Hooks, you can build your own custom hooks on top of it. One of the custom hooks that I usually create is the integration with a back-end server through a <a target="_blank" rel="noopener noreferrer nofollow" href="https://restfulapi.net/">REST API</a>, because when your front-end application interacts with an API, you would want to display the different states on your <a target="_blank" rel="noopener noreferrer nofollow" href="https://en.wikipedia.org/wiki/User_interface">UI</a> for users to know when it is loading, when it is successful, or when there&#x27;s an error. It is also good to separate your custom hooks from your components to make it reusable and it also makes it easier to write tests for them. Follow me along as I build a simple custom API hook using <a target="_blank" rel="noopener noreferrer nofollow" href="https://reactjs.org/">React</a> and <a target="_blank" rel="noopener noreferrer nofollow" href="https://www.typescriptlang.org/">TypeScript</a>, as well as write tests for it using <a target="_blank" rel="noopener noreferrer nofollow" href="https://jestjs.io/">Jest</a> and <a target="_blank" rel="noopener noreferrer nofollow" href="https://testing-library.com/">Testing Library</a>.</p>
<h2>Prerequisites</h2>
<p>This is the <a target="_blank" href="/react-typescript-api-hooks/">link</a> to the web application which we&#x27;ll accomplish by the end of this post, you can see and play around with it or use it as your reference throughout this tutorial.</p>
<p>Upon writing this post, I assume that you have some web development background and basic knowledge regarding <a target="_blank" rel="noopener noreferrer nofollow" href="https://www.npmjs.com/">npm</a>, <a target="_blank" rel="noopener noreferrer nofollow" href="https://classic.yarnpkg.com/lang/en/">yarn</a>, <a target="_blank" rel="noopener noreferrer nofollow" href="https://developer.mozilla.org/en-US/docs/Web/HTML">HTML</a>, <a target="_blank" rel="noopener noreferrer nofollow" href="https://developer.mozilla.org/en-US/docs/Web/CSS">CSS</a>, <a target="_blank" rel="noopener noreferrer nofollow" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript">JavaScript</a> and <a target="_blank" rel="noopener noreferrer nofollow" href="https://reactjs.org/">React</a>.</p>
<p>Fastest way to start a new project with React is using <a target="_blank" rel="noopener noreferrer nofollow" href="https://create-react-app.dev/">Create React App</a>. It is an officially supported way to create single-page React applications. It offers a modern build setup with no configuration so you can focus on code, not build tools.</p>
<p>To create our project with React and TypeScript, run this command in your terminal:</p>
<pre><code class="hljs language-bash">yarn create react-app react-typescript-api-hooks --template typescript
</code></pre>
<p>Once project is initiated, install the additional libraries which we&#x27;ll be using later on:</p>
<pre><code class="hljs language-bash"><span class="hljs-built_in">cd</span> react-typescript-api-hooks
yarn add axios @testing-library/react-hooks faker@5.5.3 @types/faker@5.5.9
</code></pre>
<p>To run our project, execute the command below:</p>
<pre><code class="hljs language-bash">yarn start
</code></pre>
<p>We&#x27;ll also be using <a target="_blank" rel="noopener noreferrer nofollow" href="https://jsonplaceholder.typicode.com/">JSONPlaceholder - Free Fake REST API</a> for this tutorial as our back-end server.</p>
<div><ins class="adsbygoogle block max-w-[1200px] mx-auto adUnit_adunit__Qsm4B" data-ad-client="ca-pub-3632473845121107" data-ad-slot="3748487753" data-ad-format="fluid" data-ad-layout="in-article" data-full-width-responsive="true" data-testid="ad-unit"></ins></div>
<h2>Knowing your API</h2>
<p>Before we start creating our custom API hook, it is good to know the details about the API that we&#x27;ll be integrating with the UI.</p>
<p>We&#x27;ll be using a simple <a target="_blank" rel="noopener noreferrer nofollow" href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Methods/GET">GET</a> API that returns a list of posts from JSONPlaceholder. You can check it out <a target="_blank" rel="noopener noreferrer nofollow" href="https://jsonplaceholder.typicode.com/posts">here</a> and the output would be something like this:</p>
<pre><code class="hljs language-json">[
  { id: <span class="hljs-number">1</span>, title: &#x27;...&#x27; <span class="hljs-comment">/* ... */</span> },
  { id: <span class="hljs-number">2</span>, title: &#x27;...&#x27; <span class="hljs-comment">/* ... */</span> },
  { id: <span class="hljs-number">3</span>, title: &#x27;...&#x27; <span class="hljs-comment">/* ... */</span> },
  <span class="hljs-comment">/* ... */</span>
  { id: <span class="hljs-number">100</span>, title: &#x27;...&#x27; <span class="hljs-comment">/* ... */</span> },
];
</code></pre>
<h2>Create the type</h2>
<p>To get started, let&#x27;s create the <a target="_blank" rel="noopener noreferrer nofollow" href="https://www.typescriptlang.org/docs/handbook/enums.html">enum</a> for the different states our UI will go through as it fetches data from the API. <code>Enums</code> allows us to define a set of named constants. It can make it easier to document intent, or create a set of distinct cases.</p>
<pre><code class="hljs language-ts"><span class="hljs-comment">// src/types.ts</span>

<span class="hljs-keyword">export</span> <span class="hljs-built_in">enum</span> FetchState {
  DEFAULT = <span class="hljs-string">&#x27;DEFAULT&#x27;</span>,
  LOADING = <span class="hljs-string">&#x27;LOADING&#x27;</span>,
  SUCCESS = <span class="hljs-string">&#x27;SUCCESS&#x27;</span>,
  ERROR = <span class="hljs-string">&#x27;ERROR&#x27;</span>,
}
</code></pre>
<p>Next, in the same file, let&#x27;s also add the <code>type</code> of the data we are expecting from the API response. It is necessary to do this as TypeScript wouldn&#x27;t be able to know what is the <code>type</code> of the data our API will return.</p>
<pre><code class="hljs language-ts">...

<span class="hljs-keyword">export</span> <span class="hljs-keyword">type</span> PostData = {
  <span class="hljs-attr">userId</span>: <span class="hljs-built_in">number</span>;
  id: <span class="hljs-built_in">number</span>;
  title: <span class="hljs-built_in">string</span>;
  body: <span class="hljs-built_in">string</span>;
};
</code></pre>
<div><ins class="adsbygoogle block max-w-[1200px] mx-auto adUnit_adunit__Qsm4B" data-ad-client="ca-pub-3632473845121107" data-ad-slot="3748487753" data-ad-format="fluid" data-ad-layout="in-article" data-full-width-responsive="true" data-testid="ad-unit"></ins></div>
<h2>Create the custom API hook</h2>
<p>Now, we&#x27;re ready to write our custom API hook. Type the following code below:</p>
<pre><code class="hljs language-ts"><span class="hljs-comment">// src/lib/api-hooks.ts</span>

<span class="hljs-keyword">import</span> axios <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;axios&#x27;</span>;
<span class="hljs-keyword">import</span> { useState } <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;react&#x27;</span>;
<span class="hljs-keyword">import</span> { FetchState, PostData } <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;../types&#x27;</span>;

<span class="hljs-keyword">export</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">useGetPosts</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">const</span> [fetchState, setFetchState] = useState(FetchState.DEFAULT);
  <span class="hljs-keyword">const</span> [posts, setPosts] = useState&lt;<span class="hljs-built_in">Array</span>&lt;PostData&gt;&gt;([]);
  <span class="hljs-keyword">const</span> getPosts = <span class="hljs-keyword">async</span> () =&gt; {
    <span class="hljs-keyword">try</span> {
      setFetchState(FetchState.LOADING);

      <span class="hljs-keyword">const</span> res = <span class="hljs-keyword">await</span> axios.get(<span class="hljs-string">&#x27;https://jsonplaceholder.typicode.com/posts&#x27;</span>);
      <span class="hljs-keyword">const</span> resData = res.data <span class="hljs-keyword">as</span> <span class="hljs-built_in">Array</span>&lt;PostData&gt;;

      setPosts(resData);
      setFetchState(FetchState.SUCCESS);
    } <span class="hljs-keyword">catch</span> (err) {
      setFetchState(FetchState.ERROR);
    }
  };

  <span class="hljs-keyword">return</span> [posts, fetchState, getPosts] <span class="hljs-keyword">as</span> <span class="hljs-keyword">const</span>;
}
</code></pre>
<p>We created 2 states, one is for the <code>FetchState</code>, which we can use in our React component to show different states of the UI. The other state is for storing the array of <code>PostData</code> which we can loop through and display one-by-one in the UI.</p>
<p>You might notice in the code we have this:</p>
<pre><code class="hljs language-ts">...
  <span class="hljs-keyword">const</span> [posts, setPosts] = useState&lt;<span class="hljs-built_in">Array</span>&lt;PostData&gt;&gt;([]);
...
</code></pre>
<p>This is how we define <code>type</code> for the <code>useState</code>. In most cases, if our data is using <a target="_blank" rel="noopener noreferrer nofollow" href="https://www.typescriptlang.org/docs/handbook/2/everyday-types.html">simple types</a> like <code>string</code>, <code>number</code> or <code>boolean</code>, we don&#x27;t have to define the <code>type</code>. If you remove <code>&lt;Array&lt;PostData&gt;&gt;</code>, the type of <code>posts</code> would then be <code>Array&lt;never&gt;</code>, that&#x27;s not really helpful for us because TypeScript doesn&#x27;t know what data we expect inside the array. For complicated types such as this, we would need to define the <code>type</code> of the state.</p>
<p>You may ask, why didn&#x27;t we do the same for <code>fetchState</code>. That&#x27;s because if the initial value of the state is using an <code>enum</code>, in this case <code>FetchState.DEFAULT</code>, TypeScript would then assume that it can only accept values from <code>FetchState</code> which is often true.</p>
<p>Another thing to take note, we also had to do <a target="_blank" rel="noopener noreferrer nofollow" href="https://www.typescriptlang.org/docs/handbook/basic-types.html#type-assertions">type assertion</a> for the <code>res.data</code> returned from the API, we can safely do so because we have the knowledge and expectation that the API would always return an array of <code>PostData</code>. Without it, TypeScript would give it a <code>type</code> of <code>any</code> which will again not be helpful for us.</p>
<p>At the last part of the code, we added <code>as const</code> for the returned array to tell TypeScript that this is a read-only array.</p>
<div><ins class="adsbygoogle block max-w-[1200px] mx-auto adUnit_adunit__Qsm4B" data-ad-client="ca-pub-3632473845121107" data-ad-slot="3748487753" data-ad-format="fluid" data-ad-layout="in-article" data-full-width-responsive="true" data-testid="ad-unit"></ins></div>
<h2>Use the custom API hook in a component</h2>
<p>Now let&#x27;s put our custom API hook into action by using it in a component. Let&#x27;s update our <code>App.tsx</code> code with the following below:</p>
<pre><code class="hljs language-tsx"><span class="hljs-comment">// src/App.tsx</span>

<span class="hljs-keyword">import</span> { useGetPosts } <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;./lib/api-hooks&#x27;</span>;
<span class="hljs-keyword">import</span> { FetchState } <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;./types&#x27;</span>;
<span class="hljs-keyword">import</span> <span class="hljs-string">&#x27;./App.css&#x27;</span>;

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">App</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">const</span> [posts, fetchState, getPosts] = useGetPosts();

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">&quot;container&quot;</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span>React TypeScript API hooks<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span>
      {fetchState === FetchState.DEFAULT &amp;&amp; (
        <span class="hljs-tag">&lt;&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>
            Hello there, click the button below to get the list of posts from
            the API.
          <span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{getPosts}</span>&gt;</span>Get Posts<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
        <span class="hljs-tag">&lt;/&gt;</span></span>
      )}
      {fetchState === FetchState.LOADING &amp;&amp; <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>Fetching posts...<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span></span>}
      {fetchState === FetchState.ERROR &amp;&amp; (
        <span class="xml"><span class="hljs-tag">&lt;&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>Oops! Something went wrong. Please try again.<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{getPosts}</span>&gt;</span>Get Posts<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
        <span class="hljs-tag">&lt;/&gt;</span></span>
      )}
      {fetchState === FetchState.SUCCESS &amp;&amp; (
        <span class="xml"><span class="hljs-tag">&lt;&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>Here&#x27;s the list of posts:<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">ul</span> <span class="hljs-attr">className</span>=<span class="hljs-string">&quot;posts-list&quot;</span>&gt;</span>
            {posts.map((post) =&gt; (
              <span class="hljs-tag">&lt;<span class="hljs-name">li</span> <span class="hljs-attr">key</span>=<span class="hljs-string">{post.id}</span> <span class="hljs-attr">className</span>=<span class="hljs-string">&quot;post&quot;</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">h3</span>&gt;</span>
                  {post.id} - {post.title}
                <span class="hljs-tag">&lt;/<span class="hljs-name">h3</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>{post.body}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
              <span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>
            ))}
          <span class="hljs-tag">&lt;/<span class="hljs-name">ul</span>&gt;</span>
        <span class="hljs-tag">&lt;/&gt;</span></span>
      )}
    &lt;/div&gt;
  );
}

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> App;
</code></pre>
<div><ins class="adsbygoogle block max-w-[1200px] mx-auto adUnit_adunit__Qsm4B" data-ad-client="ca-pub-3632473845121107" data-ad-slot="3748487753" data-ad-format="fluid" data-ad-layout="in-article" data-full-width-responsive="true" data-testid="ad-unit"></ins></div>
<p>Once you saved it, your React application should display something like this:</p>
<div class="lazyload-wrapper "><div class="lazyload-placeholder"></div></div>
<p>Now before we interact we it, let&#x27;s update the styles to make our application slightly prettier.</p>
<pre><code class="hljs language-css"><span class="hljs-comment">/* src/index.css */</span>

* {
  <span class="hljs-attribute">box-sizing</span>: border-box;
}

<span class="hljs-selector-tag">body</span> {
  <span class="hljs-attribute">margin</span>: <span class="hljs-number">0</span>;
  <span class="hljs-attribute">font-family</span>: -apple-system, BlinkMacSystemFont, <span class="hljs-string">&#x27;Segoe UI&#x27;</span>, <span class="hljs-string">&#x27;Roboto&#x27;</span>,
    <span class="hljs-string">&#x27;Oxygen&#x27;</span>, <span class="hljs-string">&#x27;Ubuntu&#x27;</span>, <span class="hljs-string">&#x27;Cantarell&#x27;</span>, <span class="hljs-string">&#x27;Fira Sans&#x27;</span>, <span class="hljs-string">&#x27;Droid Sans&#x27;</span>,
    <span class="hljs-string">&#x27;Helvetica Neue&#x27;</span>, sans-serif;
  -webkit-<span class="hljs-attribute">font-smoothing</span>: antialiased;
  -moz-osx-<span class="hljs-attribute">font-smoothing</span>: grayscale;
  <span class="hljs-attribute">line-height</span>: <span class="hljs-number">1.6</span>;
}
</code></pre>
<pre><code class="hljs language-css"><span class="hljs-comment">/* src/App.css */</span>

<span class="hljs-selector-class">.container</span> {
  <span class="hljs-attribute">width</span>: <span class="hljs-number">600px</span>;
  <span class="hljs-attribute">max-width</span>: <span class="hljs-number">100%</span>;
  <span class="hljs-attribute">margin</span>: <span class="hljs-number">0</span> auto;
  <span class="hljs-attribute">padding</span>: <span class="hljs-number">20px</span> <span class="hljs-number">15px</span>;
}

<span class="hljs-selector-class">.posts-list</span> {
  <span class="hljs-attribute">list-style</span>: none;
  <span class="hljs-attribute">padding</span>: <span class="hljs-number">0</span>;
  <span class="hljs-attribute">margin</span>: <span class="hljs-number">0</span>;
}

<span class="hljs-selector-class">.post</span> {
  <span class="hljs-attribute">margin-top</span>: <span class="hljs-number">10px</span>;
  <span class="hljs-attribute">padding</span>: <span class="hljs-number">0</span> <span class="hljs-number">15px</span>;
  <span class="hljs-attribute">border</span>: <span class="hljs-number">1px</span> solid <span class="hljs-number">#ccc</span>;
}

<span class="hljs-selector-class">.post</span> <span class="hljs-selector-tag">h3</span> {
  <span class="hljs-attribute">color</span>: <span class="hljs-number">#222</span>;
}

<span class="hljs-selector-class">.post</span> <span class="hljs-selector-tag">p</span> {
  <span class="hljs-attribute">color</span>: <span class="hljs-number">#777</span>;
}
</code></pre>
<p>Alright, now try clicking the &quot;Get Posts&quot; button. You should briefly see the loading state:</p>
<div class="lazyload-wrapper "><div class="lazyload-placeholder"></div></div>
<p>Then eventually the list of posts:</p>
<div class="lazyload-wrapper "><div class="lazyload-placeholder"></div></div>
<p>Alright, everything is working fine as expected.</p>
<p>If you would like to see the error state. Simple add a <code>throw</code> inside the <code>getPosts</code> function like this:</p>
<pre><code class="hljs language-ts">
...
  <span class="hljs-keyword">const</span> getPosts = <span class="hljs-keyword">async</span> () =&gt; {
    <span class="hljs-keyword">try</span> {
      <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(); <span class="hljs-comment">// <span class="hljs-doctag">TODO:</span> remove this after seeing the error state</span>
      ...
    } <span class="hljs-keyword">catch</span> (err) {
      ...
    }
  };
</code></pre>
<p>When you click the &quot;Get Posts&quot; button again. It will display something like this:</p>
<div class="lazyload-wrapper "><div class="lazyload-placeholder"></div></div>
<p>Awesome! Remove the <code>throw</code> code and we can start writing tests.</p>
<div><ins class="adsbygoogle block max-w-[1200px] mx-auto adUnit_adunit__Qsm4B" data-ad-client="ca-pub-3632473845121107" data-ad-slot="3748487753" data-ad-format="fluid" data-ad-layout="in-article" data-full-width-responsive="true" data-testid="ad-unit"></ins></div>
<h2>Write tests for App component</h2>
<p>Update the code of <code>App.test.tsx</code> for our first test case which is to check the default state:</p>
<pre><code class="hljs language-tsx"><span class="hljs-comment">// src/App.test.tsx</span>

<span class="hljs-keyword">import</span> { render, screen } <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;@testing-library/react&#x27;</span>;
<span class="hljs-keyword">import</span> App <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;./App&#x27;</span>;

describe(<span class="hljs-string">&#x27;&lt;App /&gt;&#x27;</span>, <span class="hljs-function">() =&gt;</span> {
  <span class="hljs-keyword">const</span> renderComponent = <span class="hljs-function">() =&gt;</span> render(<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">App</span> /&gt;</span></span>);
  <span class="hljs-keyword">const</span> defaultText =
    <span class="hljs-string">&#x27;Hello there, click the button below to get the list of posts from the API.&#x27;</span>;
  <span class="hljs-keyword">const</span> loadingText = <span class="hljs-string">&#x27;Fetching posts...&#x27;</span>;
  <span class="hljs-keyword">const</span> errorText = <span class="hljs-string">&#x27;Oops! Something went wrong. Please try again.&#x27;</span>;
  <span class="hljs-keyword">const</span> successText = <span class="hljs-string">&quot;Here&#x27;s the list of posts:&quot;</span>;

  it(<span class="hljs-string">&#x27;should render default state&#x27;</span>, <span class="hljs-function">() =&gt;</span> {
    renderComponent();

    <span class="hljs-keyword">const</span> stateEl = screen.queryByText(defaultText);

    expect(stateEl).toBeInTheDocument();
  });
});
</code></pre>
<p>Here we defined all the expected description for each states and check whether an element with a text of <code>defaultText</code> is in the document.</p>
<p>To see if our test case passed along with the coverage, run this command on your terminal:</p>
<pre><code class="hljs language-bash">yarn <span class="hljs-built_in">test</span> --coverage
</code></pre>
<p>You don&#x27;t have to run this command again when you make changes, it will automatically re-run just like <code>yarn start</code>.</p>
<p>For the second test case, let&#x27;s check whether the description is correct during the loading state. We will have to mock the <code>useGetPosts()</code> in order to control the state it returns and do the checks. This also ensures that we are not doing an actual fetch to the API. Mocking data fetching with &quot;fake&quot; data prevents flaky tests due to an unavailable back-end server and makes our tests run faster too.</p>
<pre><code class="hljs language-tsx"><span class="hljs-comment">// src/App.test.tsx</span>

...
<span class="hljs-keyword">import</span> * <span class="hljs-keyword">as</span> apiHooks <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;./lib/api-hooks&#x27;</span>;
<span class="hljs-keyword">import</span> { FetchState } <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;./types&#x27;</span>;

describe(<span class="hljs-string">&#x27;&lt;App /&gt;&#x27;</span>, <span class="hljs-function">() =&gt;</span> {
  ...

  afterEach(<span class="hljs-function">() =&gt;</span> {
    jest.restoreAllMocks();
  });

  ...

  it(<span class="hljs-string">&#x27;should render loading state on loading&#x27;</span>, <span class="hljs-function">() =&gt;</span> {
    <span class="hljs-keyword">const</span> fetchState = FetchState.LOADING;

    jest
      .spyOn(apiHooks, <span class="hljs-string">&#x27;useGetPosts&#x27;</span>)
      .mockReturnValue([[], fetchState, jest.fn()]);

    renderComponent();

    <span class="hljs-keyword">const</span> stateEl = screen.queryByText(loadingText);

    expect(stateEl).toBeInTheDocument();
  });
});
</code></pre>
<p>When mocking functions, we would need to call <code>jest.restoreAllMocks()</code> after each tests using <code>afterEach</code> to revert it back to its original state to prevent it from affecting other test cases.</p>
<div><ins class="adsbygoogle block max-w-[1200px] mx-auto adUnit_adunit__Qsm4B" data-ad-client="ca-pub-3632473845121107" data-ad-slot="3748487753" data-ad-format="fluid" data-ad-layout="in-article" data-full-width-responsive="true" data-testid="ad-unit"></ins></div>
<p>Let&#x27;s add the code for the third test case to check the error state, it would be similar from the previous test case:</p>
<pre><code class="hljs language-tsx">  ...

  it(<span class="hljs-string">&#x27;should render error state on error&#x27;</span>, <span class="hljs-function">() =&gt;</span> {
    <span class="hljs-keyword">const</span> fetchState = FetchState.ERROR;

    jest
      .spyOn(apiHooks, <span class="hljs-string">&#x27;useGetPosts&#x27;</span>)
      .mockReturnValue([[], fetchState, jest.fn()]);

    renderComponent();

    <span class="hljs-keyword">const</span> stateEl = screen.queryByText(errorText);

    expect(stateEl).toBeInTheDocument();
  });
});
</code></pre>
<p>Next, for the fourth test case, we will check whether both the expected description is rendered as well as the post data. We can make use of the library <a target="_blank" rel="noopener noreferrer nofollow" href="https://github.com/marak/faker.js">faker</a> to generate random data for us which makes our test more reliable.</p>
<pre><code class="hljs language-tsx"><span class="hljs-comment">// src/App.test.tsx</span>
<span class="hljs-keyword">import</span> faker <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;faker&#x27;</span>;

  ...

  it(<span class="hljs-string">&#x27;should render success state on success&#x27;</span>, <span class="hljs-function">() =&gt;</span> {
    <span class="hljs-keyword">const</span> fetchState = FetchState.SUCCESS;
    <span class="hljs-keyword">const</span> posts = [
      {
        <span class="hljs-attr">userId</span>: faker.datatype.number(),
        <span class="hljs-attr">id</span>: faker.datatype.number(),
        <span class="hljs-attr">title</span>: faker.lorem.sentence(),
        <span class="hljs-attr">body</span>: faker.lorem.sentences(),
      },
    ];

    jest
      .spyOn(apiHooks, <span class="hljs-string">&#x27;useGetPosts&#x27;</span>)
      .mockReturnValue([posts, fetchState, jest.fn()]);

    renderComponent();

    <span class="hljs-keyword">const</span> stateEl = screen.queryByText(successText);
    <span class="hljs-keyword">const</span> post = posts[<span class="hljs-number">0</span>];
    <span class="hljs-keyword">const</span> postTitle = <span class="hljs-string">`<span class="hljs-subst">${post.id}</span> - <span class="hljs-subst">${post.title}</span>`</span>;
    <span class="hljs-keyword">const</span> postEl = screen.queryByText(postTitle);

    expect(stateEl).toBeInTheDocument();
    expect(postEl).toBeInTheDocument();
  });
});
</code></pre>
<p>For the last test case of <code>App.tsx</code>, we just need to check that the <code>getPosts</code> function from the custom hook is called when the &quot;Get Posts&quot; button is clicked. Add the following code below:</p>
<pre><code class="hljs language-tsx"><span class="hljs-keyword">import</span> { fireEvent, render, screen } <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;@testing-library/react&#x27;</span>;
  ...

  it(<span class="hljs-string">&#x27;should call API on button click&#x27;</span>, <span class="hljs-function">() =&gt;</span> {
    <span class="hljs-keyword">const</span> getPostsMock = jest.fn();

    jest
      .spyOn(apiHooks, <span class="hljs-string">&#x27;useGetPosts&#x27;</span>)
      .mockReturnValue([[], FetchState.DEFAULT, getPostsMock]);

    renderComponent();

    <span class="hljs-keyword">const</span> btnEl = screen.queryByText(<span class="hljs-string">&#x27;Get Posts&#x27;</span>) <span class="hljs-keyword">as</span> HTMLButtonElement;

    fireEvent.click(btnEl);

    expect(getPostsMock).toBeCalledTimes(<span class="hljs-number">1</span>);
  });
</code></pre>
<p>We are using <a target="_blank" rel="noopener noreferrer nofollow" href="https://testing-library.com/docs/dom-testing-library/api-events/">fireEvent</a> function by Testing Library to fire a click event. It only accepts an element so we had to do a type assertion when querying the button element.</p>
<div><ins class="adsbygoogle block max-w-[1200px] mx-auto adUnit_adunit__Qsm4B" data-ad-client="ca-pub-3632473845121107" data-ad-slot="3748487753" data-ad-format="fluid" data-ad-layout="in-article" data-full-width-responsive="true" data-testid="ad-unit"></ins></div>
<p>If you check the coverage on your terminal, it should be 100% now for <code>App.tsx</code>.</p>
<p>That&#x27;s great! Now are the done with the component tests. Let&#x27;s move on to write tests for our custom API hook.</p>
<h2>Write tests for custom API hook</h2>
<p>For the first test case, we just need to check that it returns the expected initial values and function. Add the following code below:</p>
<pre><code class="hljs language-ts"><span class="hljs-comment">// src/lib/api-hooks.test.ts</span>

<span class="hljs-keyword">import</span> { renderHook } <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;@testing-library/react-hooks&#x27;</span>;
<span class="hljs-keyword">import</span> { FetchState } <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;../types&#x27;</span>;
<span class="hljs-keyword">import</span> { useGetPosts } <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;./api-hooks&#x27;</span>;

describe(<span class="hljs-string">&#x27;api hooks utilities&#x27;</span>, <span class="hljs-function">() =&gt;</span> {
  describe(<span class="hljs-string">&#x27;useGetPosts()&#x27;</span>, <span class="hljs-function">() =&gt;</span> {
    <span class="hljs-keyword">const</span> renderCustomHook = <span class="hljs-function">() =&gt;</span> renderHook(<span class="hljs-function">() =&gt;</span> useGetPosts());

    it(<span class="hljs-string">&#x27;should return initial value&#x27;</span>, <span class="hljs-function">() =&gt;</span> {
      <span class="hljs-keyword">const</span> hook = renderCustomHook();
      <span class="hljs-keyword">const</span> [posts, fetchState, getPosts] = hook.result.current;

      expect(posts).toEqual([]);
      expect(fetchState).toBe(FetchState.DEFAULT);
      expect(<span class="hljs-keyword">typeof</span> getPosts).toBe(<span class="hljs-string">&#x27;function&#x27;</span>);
    });
  });
});
</code></pre>
<p>For the second test case, let&#x27;s check whether it is calling the expected API endpoint when the function is executed.</p>
<pre><code class="hljs language-ts"><span class="hljs-keyword">import</span> { act, renderHook } <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;@testing-library/react-hooks&#x27;</span>;
<span class="hljs-keyword">import</span> axios <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;axios&#x27;</span>;

    ...

    afterEach(<span class="hljs-function">() =&gt;</span> {
      jest.restoreAllMocks();
    });

    ...

    it(<span class="hljs-string">&#x27;should have expected endpoint on api call&#x27;</span>, <span class="hljs-keyword">async</span> () =&gt; {
      <span class="hljs-keyword">const</span> axiosGetSpy = jest
        .spyOn(axios, <span class="hljs-string">&#x27;get&#x27;</span>)
        .mockResolvedValue({ <span class="hljs-attr">data</span>: [] });

      <span class="hljs-keyword">const</span> hook = renderCustomHook();
      <span class="hljs-keyword">const</span> getPosts = hook.result.current[<span class="hljs-number">2</span>];

      <span class="hljs-keyword">await</span> act(<span class="hljs-keyword">async</span> () =&gt; {
        <span class="hljs-keyword">await</span> getPosts();
      });

      expect(axiosGetSpy).toBeCalledTimes(<span class="hljs-number">1</span>);
      expect(axiosGetSpy).toBeCalledWith(
        <span class="hljs-string">&#x27;https://jsonplaceholder.typicode.com/posts&#x27;</span>
      );
    });
  ...
</code></pre>
<p>We are mocking the <code>axios</code> here to prevent doing an actual fetch. We also used <a target="_blank" rel="noopener noreferrer nofollow" href="https://reactjs.org/docs/testing-recipes.html#act">act</a> function which makes sure all updates related to this action have been processed and applied to the DOM before we make any assertions. This is usually done when the function you executed in the test case makes an update on the React states. When also added <code>async</code> and <code>await</code> because <code>getPosts()</code> is an asynchronous function and ideally we should wait for it to be done before we do our checks.</p>
<p>For the third test case, we need to check whether we are getting the expected states on API call, we are expecting we will get a loading state while waiting for the API to return the response. Here&#x27;s the code for that:</p>
<pre><code class="hljs language-ts">    ...

    it(<span class="hljs-string">&#x27;should have expected states on api call&#x27;</span>, <span class="hljs-keyword">async</span> () =&gt; {
      jest.spyOn(axios, <span class="hljs-string">&#x27;get&#x27;</span>).mockResolvedValue({ <span class="hljs-attr">data</span>: [] });

      <span class="hljs-keyword">const</span> hook = renderCustomHook();
      <span class="hljs-keyword">const</span> getPosts = hook.result.current[<span class="hljs-number">2</span>];

      <span class="hljs-keyword">const</span> promiseAct = act(<span class="hljs-keyword">async</span> () =&gt; {
        <span class="hljs-keyword">await</span> getPosts();
      });

      <span class="hljs-keyword">const</span> [posts, fetchState] = hook.result.current;

      expect(posts).toEqual([]);
      expect(fetchState).toBe(FetchState.LOADING);

      <span class="hljs-keyword">await</span> promiseAct;
    });
  ...
</code></pre>
<p>As you would notice, we didn&#x27;t do an <code>await</code> for the <code>act</code> function right away, we had to store it in a variable and do an <code>await</code> at the end because if we didn&#x27;t, we would be getting <code>FetchState.SUCCESS</code> instead which is for a later test case.</p>
<div><ins class="adsbygoogle block max-w-[1200px] mx-auto adUnit_adunit__Qsm4B" data-ad-client="ca-pub-3632473845121107" data-ad-slot="3748487753" data-ad-format="fluid" data-ad-layout="in-article" data-full-width-responsive="true" data-testid="ad-unit"></ins></div>
<p>For the fourth test case, we need to check whether we are getting the expected state when the API fails. Add the following code below to do so:</p>
<pre><code class="hljs language-ts">    ...

    it(<span class="hljs-string">&#x27;should have expected states on api error&#x27;</span>, <span class="hljs-keyword">async</span> () =&gt; {
      jest.spyOn(axios, <span class="hljs-string">&#x27;get&#x27;</span>).mockRejectedValue({});

      <span class="hljs-keyword">const</span> hook = renderCustomHook();
      <span class="hljs-keyword">const</span> getPosts = hook.result.current[<span class="hljs-number">2</span>];

      <span class="hljs-keyword">await</span> act(<span class="hljs-keyword">async</span> () =&gt; {
        <span class="hljs-keyword">await</span> getPosts();
      });

      <span class="hljs-keyword">const</span> [posts, fetchState] = hook.result.current;

      expect(posts).toEqual([]);
      expect(fetchState).toBe(FetchState.ERROR);
    });
  ...
</code></pre>
<p>Here we are mocking <code>axios</code> with <code>.mockRejectedValue({})</code> in order to throw an error when fetching the data.</p>
<p>For the last test case, we need to check whether we are getting the expected state when the API succeeds. This time the posts should not be an empty array. We will use <code>faker</code> library again to mock the data for us. Here&#x27;s the code below:</p>
<pre><code class="hljs language-ts"><span class="hljs-keyword">import</span> faker <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;faker&#x27;</span>;

    ...

    it(<span class="hljs-string">&#x27;should have expected states on api success&#x27;</span>, <span class="hljs-keyword">async</span> () =&gt; {
      <span class="hljs-keyword">const</span> res = {
        <span class="hljs-attr">data</span>: [
          {
            <span class="hljs-attr">userId</span>: faker.datatype.number(),
            <span class="hljs-attr">id</span>: faker.datatype.number(),
            <span class="hljs-attr">title</span>: faker.lorem.sentence(),
            <span class="hljs-attr">body</span>: faker.lorem.sentences(),
          },
        ],
      };

      jest.spyOn(axios, <span class="hljs-string">&#x27;get&#x27;</span>).mockResolvedValue(res);

      <span class="hljs-keyword">const</span> hook = renderCustomHook();
      <span class="hljs-keyword">const</span> getPosts = hook.result.current[<span class="hljs-number">2</span>];

      <span class="hljs-keyword">await</span> act(<span class="hljs-keyword">async</span> () =&gt; {
        <span class="hljs-keyword">await</span> getPosts();
      });

      <span class="hljs-keyword">const</span> [posts, fetchState] = hook.result.current;

      expect(posts).toEqual(res.data);
      expect(fetchState).toBe(FetchState.SUCCESS);
    });
  ...
</code></pre>
<div><ins class="adsbygoogle block max-w-[1200px] mx-auto adUnit_adunit__Qsm4B" data-ad-client="ca-pub-3632473845121107" data-ad-slot="3748487753" data-ad-format="fluid" data-ad-layout="in-article" data-full-width-responsive="true" data-testid="ad-unit"></ins></div>
<p>And they&#x27;re you have it!</p>
<p>By now, you should have achieved 100% test coverage and all looking green in your terminal just like this:</p>
<div class="lazyload-wrapper "><div class="lazyload-placeholder"></div></div>
<p>If you&#x27;re up for a challenge, try creating your own custom API hook with the rest of the APIs by JSONPlaceholder <a target="_blank" rel="noopener noreferrer nofollow" href="https://jsonplaceholder.typicode.com/guide/">here</a> using what you&#x27;ve learned from this post.</p>
<p>In case you need the final code as a reference, this is the <a target="_blank" rel="noopener noreferrer nofollow" href="https://github.com/dominicarrojado/react-typescript-api-hooks">link</a> to the GitHub repository.</p>
<p>Please don&#x27;t forget to share this post if you find it helpful. Thank you ~</p></article><div class="w-11/12 max-w-screen-3xl mx-auto lg:w-5/6"><p class="mt-16 text-gray-400">Found an issue with this post?<!-- --> <a target="_blank" rel="noopener noreferrer nofollow" href="https://github.com/dominicarrojado/dominicarrojado.github.io/issues">Report it here</a>.</p><div class="mt-24 flex justify-between items-center"><a class="group relative pr-2" href="/posts/the-turning-point/"><div class=""><div class="font-normal transition-colors duration-300 group-hover:text-black motion-reduce:transition-none dark:group-hover:text-white">The Turning Point</div><small class="text-gray-400 transition-colors duration-300 group-hover:text-black motion-reduce:transition-none dark:group-hover:text-white">Previous Post</small></div><svg viewBox="0 0 320 512" role="img" class="absolute top-0 bottom-0 m-auto shrink-0 w-2 h-2 text-black opacity-30 dark:text-white transform transition-transform-opacity duration-300 group-hover:opacity-100 motion-reduce:transition-none sm:w-2.5 sm:h-2.5 md:w-3 md:h-3 xl:w-3.5 xl:h-3.5 -left-5 sm:-left-7 xl:-left-8 group-hover:-translate-x-1.5"><path fill="currentColor" d="M34.52 239.03L228.87 44.69c9.37-9.37 24.57-9.37 33.94 0l22.67 22.67c9.36 9.36 9.37 24.52.04 33.9L131.49 256l154.02 154.75c9.34 9.38 9.32 24.54-.04 33.9l-22.67 22.67c-9.37 9.37-24.57 9.37-33.94 0L34.52 272.97c-9.37-9.37-9.37-24.57 0-33.94z"></path></svg></a><div></div><a class="group relative pl-2" href="/posts/how-to-create-your-own-swiper-in-react-and-typescript-with-tests-part-1/"><div class="text-right"><div class="font-normal transition-colors duration-300 group-hover:text-black motion-reduce:transition-none dark:group-hover:text-white">How to create your own swiper, carousel or slider in React and TypeScript with tests (Part 1)</div><small class="text-gray-400 transition-colors duration-300 group-hover:text-black motion-reduce:transition-none dark:group-hover:text-white">Next Post</small></div><svg viewBox="0 0 320 512" role="img" class="absolute top-0 bottom-0 m-auto shrink-0 w-2 h-2 text-black opacity-30 dark:text-white transform transition-transform-opacity duration-300 group-hover:opacity-100 motion-reduce:transition-none sm:w-2.5 sm:h-2.5 md:w-3 md:h-3 xl:w-3.5 xl:h-3.5 -right-5 sm:-right-7 xl:-right-8 group-hover:translate-x-1.5"><path fill="currentColor" d="M285.476 272.971L91.132 467.314c-9.373 9.373-24.569 9.373-33.941 0l-22.667-22.667c-9.357-9.357-9.375-24.522-.04-33.901L188.505 256 34.484 101.255c-9.335-9.379-9.317-24.544.04-33.901l22.667-22.667c9.373-9.373 24.569-9.373 33.941 0L285.475 239.03c9.373 9.372 9.373 24.568.001 33.941z"></path></svg></a></div><div class="mt-16 text-center"><a class="group inline-flex items-center font-normal select-none dark:hover:text-white transition-colors duration-300 hover:text-black group-hover:text-black motion-reduce:transition-none" href="/posts/">See Latest Posts<svg viewBox="0 0 320 512" role="img" class="inline-block w-2 h-2 ml-2 text-black opacity-30 dark:text-white transform transition duration-300 group-hover:translate-x-1.5 group-hover:opacity-100 motion-reduce:transition-none sm:w-2.5 sm:h-2.5 sm:ml-2.5 md:w-3 md:h-3 md:ml-3 xl:w-3.5 xl:h-3.5"><path fill="currentColor" d="M285.476 272.971L91.132 467.314c-9.373 9.373-24.569 9.373-33.941 0l-22.667-22.667c-9.357-9.357-9.375-24.522-.04-33.901L188.505 256 34.484 101.255c-9.335-9.379-9.317-24.544.04-33.901l22.667-22.667c9.373-9.373 24.569-9.373 33.941 0L285.475 239.03c9.373 9.372 9.373 24.568.001 33.941z"></path></svg></a></div></div><div class="w-11/12 max-w-screen-3xl -mb-8 mx-auto pt-8 sm:-mb-10 sm:pt-10 md:-mb-12 md:pt-12 lg:w-5/6"><ins class="adsbygoogle block max-w-[1200px] mx-auto adUnit_adunit__Qsm4B" data-ad-client="ca-pub-3632473845121107" data-ad-slot="6892691691" data-ad-format="auto" data-full-width-responsive="true" data-testid="ad-unit"></ins></div></section><footer class="py-20 px-6 bg-gray-100 dark:bg-gray-850 overflow-hidden lg:overflow-auto transition-opacity duration-1000 delay-1750 motion-reduce:transition-none opacity-0" data-testid="footer"><ul class="relative text-center overflow-hidden transition-height duration-1000 motion-reduce:transition-none sm:text-lg xl:text-xl" style="height:0"><li class="absolute top-0 left-0 w-full transition-opacity duration-1000 motion-reduce:transition-none"><blockquote><!-- -->If there is no struggle, there is no progress.<!-- --></blockquote><p class="mt-1 sm:mt-2"> <!-- -->Frederick Douglass</p></li><li class="absolute top-0 left-0 w-full transition-opacity duration-1000 motion-reduce:transition-none opacity-0 pointer-events-none"><blockquote><!-- -->It&#x27;s okay to figure out murder mysteries, but you shouldn&#x27;t need to figure out code. You should be able to read it.<!-- --></blockquote><p class="mt-1 sm:mt-2"> <!-- -->Steve McConnell</p></li><li class="absolute top-0 left-0 w-full transition-opacity duration-1000 motion-reduce:transition-none opacity-0 pointer-events-none"><blockquote><!-- -->If you can&#x27;t explain it simply, you don&#x27;t understand it well enough.<!-- --></blockquote><p class="mt-1 sm:mt-2"> <!-- -->Albert Einstein</p></li><li class="absolute top-0 left-0 w-full transition-opacity duration-1000 motion-reduce:transition-none opacity-0 pointer-events-none"><blockquote><!-- -->The secret of getting ahead is getting started.<!-- --></blockquote><p class="mt-1 sm:mt-2"> <!-- -->Mark Twain</p></li></ul><ul class="max-w-full mt-10 flex flex-wrap justify-center lg:hidden"><li class="flex lg:transform lg:transition lg:ease-in-out lg:duration-500 motion-reduce:lg:transition-none lg:opacity-0 lg:translate-y-full" style="transition-delay:2050ms"><a target="_blank" rel="noopener noreferrer nofollow" tabindex="0" aria-describedby="tooltip-donate" href="https://www.paypal.com/paypalme/DominicArrojado" class="group inline-flex p-3 cursor-pointer sm:p-4" aria-label="Show your support and donate!"><svg viewBox="0 0 512 512" role="img" class="w-7 h-7 text-gray-400 dark:text-gray-300 transition-colors group-hover:text-gray-500 motion-reduce:transition-none dark:group-hover:text-white sm:w-8 sm:h-8 xl:w-9 xl:h-9"><path fill="currentColor" d="M256 416c114.9 0 208-93.1 208-208S370.9 0 256 0 48 93.1 48 208s93.1 208 208 208zM233.8 97.4V80.6c0-9.2 7.4-16.6 16.6-16.6h11.1c9.2 0 16.6 7.4 16.6 16.6v17c15.5.8 30.5 6.1 43 15.4 5.6 4.1 6.2 12.3 1.2 17.1L306 145.6c-3.8 3.7-9.5 3.8-14 1-5.4-3.4-11.4-5.1-17.8-5.1h-38.9c-9 0-16.3 8.2-16.3 18.3 0 8.2 5 15.5 12.1 17.6l62.3 18.7c25.7 7.7 43.7 32.4 43.7 60.1 0 34-26.4 61.5-59.1 62.4v16.8c0 9.2-7.4 16.6-16.6 16.6h-11.1c-9.2 0-16.6-7.4-16.6-16.6v-17c-15.5-.8-30.5-6.1-43-15.4-5.6-4.1-6.2-12.3-1.2-17.1l16.3-15.5c3.8-3.7 9.5-3.8 14-1 5.4 3.4 11.4 5.1 17.8 5.1h38.9c9 0 16.3-8.2 16.3-18.3 0-8.2-5-15.5-12.1-17.6l-62.3-18.7c-25.7-7.7-43.7-32.4-43.7-60.1.1-34 26.4-61.5 59.1-62.4zM480 352h-32.5c-19.6 26-44.6 47.7-73 64h63.8c5.3 0 9.6 3.6 9.6 8v16c0 4.4-4.3 8-9.6 8H73.6c-5.3 0-9.6-3.6-9.6-8v-16c0-4.4 4.3-8 9.6-8h63.8c-28.4-16.3-53.3-38-73-64H32c-17.7 0-32 14.3-32 32v96c0 17.7 14.3 32 32 32h448c17.7 0 32-14.3 32-32v-96c0-17.7-14.3-32-32-32z"></path></svg></a></li><li class="flex lg:transform lg:transition lg:ease-in-out lg:duration-500 motion-reduce:lg:transition-none lg:opacity-0 lg:translate-y-full" style="transition-delay:2200ms"><a target="_blank" rel="noopener noreferrer nofollow" tabindex="0" aria-describedby="tooltip-youtube" href="https://www.youtube.com/channel/UCWwV__qrzg5BYCSwO91Xhxg/videos?view=0&amp;sort=dd" class="group inline-flex p-3 cursor-pointer sm:p-4" aria-label="Watch my tech videos!"><svg viewBox="0 0 576 512" role="img" class="w-7 h-7 text-gray-400 dark:text-gray-300 transition-colors group-hover:text-gray-500 motion-reduce:transition-none dark:group-hover:text-white sm:w-8 sm:h-8 xl:w-9 xl:h-9"><path fill="currentColor" d="M549.655 124.083c-6.281-23.65-24.787-42.276-48.284-48.597C458.781 64 288 64 288 64S117.22 64 74.629 75.486c-23.497 6.322-42.003 24.947-48.284 48.597-11.412 42.867-11.412 132.305-11.412 132.305s0 89.438 11.412 132.305c6.281 23.65 24.787 41.5 48.284 47.821C117.22 448 288 448 288 448s170.78 0 213.371-11.486c23.497-6.321 42.003-24.171 48.284-47.821 11.412-42.867 11.412-132.305 11.412-132.305s0-89.438-11.412-132.305zm-317.51 213.508V175.185l142.739 81.205-142.739 81.201z"></path></svg></a></li><li class="flex lg:transform lg:transition lg:ease-in-out lg:duration-500 motion-reduce:lg:transition-none lg:opacity-0 lg:translate-y-full" style="transition-delay:2350ms"><a target="_blank" rel="noopener noreferrer nofollow" tabindex="0" aria-describedby="tooltip-linkedin" href="https://www.linkedin.com/in/dominic-arrojado-75ba03a9/" class="group inline-flex p-3 cursor-pointer sm:p-4" aria-label="Let&#x27;s connect on LinkedIn!"><svg viewBox="0 0 448 512" role="img" class="w-7 h-7 text-gray-400 dark:text-gray-300 transition-colors group-hover:text-gray-500 motion-reduce:transition-none dark:group-hover:text-white sm:w-8 sm:h-8 xl:w-9 xl:h-9"><path fill="currentColor" d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9V416z"></path></svg></a></li><li class="flex lg:transform lg:transition lg:ease-in-out lg:duration-500 motion-reduce:lg:transition-none lg:opacity-0 lg:translate-y-full" style="transition-delay:2500ms"><a target="_blank" rel="noopener noreferrer nofollow" tabindex="0" aria-describedby="tooltip-github" href="https://github.com/dominicarrojado/" class="group inline-flex p-3 cursor-pointer sm:p-4" aria-label="Follow me on GitHub!"><svg viewBox="0 0 496 512" role="img" class="w-7 h-7 text-gray-400 dark:text-gray-300 transition-colors group-hover:text-gray-500 motion-reduce:transition-none dark:group-hover:text-white sm:w-8 sm:h-8 xl:w-9 xl:h-9"><path fill="currentColor" d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"></path></svg></a></li><li class="flex lg:transform lg:transition lg:ease-in-out lg:duration-500 motion-reduce:lg:transition-none lg:opacity-0 lg:translate-y-full" style="transition-delay:2650ms"><a target="_blank" rel="noopener noreferrer nofollow" tabindex="0" aria-describedby="tooltip-email" href="mailto:dominicarrojado@gmail.com" class="group inline-flex p-3 cursor-pointer sm:p-4" aria-label="Email me!"><svg viewBox="0 0 512 512" role="img" class="w-7 h-7 text-gray-400 dark:text-gray-300 transition-colors group-hover:text-gray-500 motion-reduce:transition-none dark:group-hover:text-white sm:w-8 sm:h-8 xl:w-9 xl:h-9"><path fill="currentColor" d="M502.3 190.8c3.9-3.1 9.7-.2 9.7 4.7V400c0 26.5-21.5 48-48 48H48c-26.5 0-48-21.5-48-48V195.6c0-5 5.7-7.8 9.7-4.7 22.4 17.4 52.1 39.5 154.1 113.6 21.1 15.4 56.7 47.8 92.2 47.6 35.7.3 72-32.8 92.3-47.6 102-74.1 131.6-96.3 154-113.7zM256 320c23.2.4 56.6-29.2 73.4-41.4 132.7-96.3 142.8-104.7 173.4-128.7 5.8-4.5 9.2-11.5 9.2-18.9v-19c0-26.5-21.5-48-48-48H48C21.5 64 0 85.5 0 112v19c0 7.4 3.4 14.3 9.2 18.9 30.6 23.9 40.7 32.4 173.4 128.7 16.8 12.2 50.2 41.8 73.4 41.4z"></path></svg></a></li></ul><p class="mt-4 text-gray-400 text-sm text-center sm:text-base lg:mt-10 xl:text-lg"><span class="font-normal"><!-- -->2022<!-- --> Dominic Arrojado</span> <span class="block mt-1 sm:hidden"></span><span class="hidden sm:inline"></span> <a href="/privacy-policy/">Privacy Policy</a> <!-- --><!-- --> <a href="/disclaimer/">Disclaimer</a></p></footer></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"postData":{"id":"how-to-integrate-with-a-rest-api-using-react-hooks-and-typescript-with-tests","content":"\n## Introduction\n\nOne of my favorite features that [React](https://reactjs.org/) introduced is [React Hooks](https://reactjs.org/docs/hooks-intro.html). They let you use state and other React features without writing a class. I personally feel that it is cleaner, more readable and much easier to build React components and features with it. Using React Hooks, you can build your own custom hooks on top of it. One of the custom hooks that I usually create is the integration with a back-end server through a [REST API](https://restfulapi.net/), because when your front-end application interacts with an API, you would want to display the different states on your [UI](https://en.wikipedia.org/wiki/User_interface) for users to know when it is loading, when it is successful, or when there's an error. It is also good to separate your custom hooks from your components to make it reusable and it also makes it easier to write tests for them. Follow me along as I build a simple custom API hook using [React](https://reactjs.org/) and [TypeScript](https://www.typescriptlang.org/), as well as write tests for it using [Jest](https://jestjs.io/) and [Testing Library](https://testing-library.com/).\n\n## Prerequisites\n\nThis is the [link](/react-typescript-api-hooks/) to the web application which we'll accomplish by the end of this post, you can see and play around with it or use it as your reference throughout this tutorial.\n\nUpon writing this post, I assume that you have some web development background and basic knowledge regarding [npm](https://www.npmjs.com/), [yarn](https://classic.yarnpkg.com/lang/en/), [HTML](https://developer.mozilla.org/en-US/docs/Web/HTML), [CSS](https://developer.mozilla.org/en-US/docs/Web/CSS), [JavaScript](https://developer.mozilla.org/en-US/docs/Web/JavaScript) and [React](https://reactjs.org/).\n\nFastest way to start a new project with React is using [Create React App](https://create-react-app.dev/). It is an officially supported way to create single-page React applications. It offers a modern build setup with no configuration so you can focus on code, not build tools.\n\nTo create our project with React and TypeScript, run this command in your terminal:\n\n```bash\nyarn create react-app react-typescript-api-hooks --template typescript\n```\n\nOnce project is initiated, install the additional libraries which we'll be using later on:\n\n```bash\ncd react-typescript-api-hooks\nyarn add axios @testing-library/react-hooks faker@5.5.3 @types/faker@5.5.9\n```\n\nTo run our project, execute the command below:\n\n```bash\nyarn start\n```\n\nWe'll also be using [JSONPlaceholder - Free Fake REST API](https://jsonplaceholder.typicode.com/) for this tutorial as our back-end server.\n\n---\n\n## Knowing your API\n\nBefore we start creating our custom API hook, it is good to know the details about the API that we'll be integrating with the UI.\n\nWe'll be using a simple [GET](https://developer.mozilla.org/en-US/docs/Web/HTTP/Methods/GET) API that returns a list of posts from JSONPlaceholder. You can check it out [here](https://jsonplaceholder.typicode.com/posts) and the output would be something like this:\n\n```json\n[\n  { id: 1, title: '...' /* ... */ },\n  { id: 2, title: '...' /* ... */ },\n  { id: 3, title: '...' /* ... */ },\n  /* ... */\n  { id: 100, title: '...' /* ... */ },\n];\n```\n\n## Create the type\n\nTo get started, let's create the [enum](https://www.typescriptlang.org/docs/handbook/enums.html) for the different states our UI will go through as it fetches data from the API. `Enums` allows us to define a set of named constants. It can make it easier to document intent, or create a set of distinct cases.\n\n```ts\n// src/types.ts\n\nexport enum FetchState {\n  DEFAULT = 'DEFAULT',\n  LOADING = 'LOADING',\n  SUCCESS = 'SUCCESS',\n  ERROR = 'ERROR',\n}\n```\n\nNext, in the same file, let's also add the `type` of the data we are expecting from the API response. It is necessary to do this as TypeScript wouldn't be able to know what is the `type` of the data our API will return.\n\n```ts\n...\n\nexport type PostData = {\n  userId: number;\n  id: number;\n  title: string;\n  body: string;\n};\n```\n\n---\n\n## Create the custom API hook\n\nNow, we're ready to write our custom API hook. Type the following code below:\n\n```ts\n// src/lib/api-hooks.ts\n\nimport axios from 'axios';\nimport { useState } from 'react';\nimport { FetchState, PostData } from '../types';\n\nexport function useGetPosts() {\n  const [fetchState, setFetchState] = useState(FetchState.DEFAULT);\n  const [posts, setPosts] = useState\u003cArray\u003cPostData\u003e\u003e([]);\n  const getPosts = async () =\u003e {\n    try {\n      setFetchState(FetchState.LOADING);\n\n      const res = await axios.get('https://jsonplaceholder.typicode.com/posts');\n      const resData = res.data as Array\u003cPostData\u003e;\n\n      setPosts(resData);\n      setFetchState(FetchState.SUCCESS);\n    } catch (err) {\n      setFetchState(FetchState.ERROR);\n    }\n  };\n\n  return [posts, fetchState, getPosts] as const;\n}\n```\n\nWe created 2 states, one is for the `FetchState`, which we can use in our React component to show different states of the UI. The other state is for storing the array of `PostData` which we can loop through and display one-by-one in the UI.\n\nYou might notice in the code we have this:\n\n```ts\n...\n  const [posts, setPosts] = useState\u003cArray\u003cPostData\u003e\u003e([]);\n...\n```\n\nThis is how we define `type` for the `useState`. In most cases, if our data is using [simple types](https://www.typescriptlang.org/docs/handbook/2/everyday-types.html) like `string`, `number` or `boolean`, we don't have to define the `type`. If you remove `\u003cArray\u003cPostData\u003e\u003e`, the type of `posts` would then be `Array\u003cnever\u003e`, that's not really helpful for us because TypeScript doesn't know what data we expect inside the array. For complicated types such as this, we would need to define the `type` of the state.\n\nYou may ask, why didn't we do the same for `fetchState`. That's because if the initial value of the state is using an `enum`, in this case `FetchState.DEFAULT`, TypeScript would then assume that it can only accept values from `FetchState` which is often true.\n\nAnother thing to take note, we also had to do [type assertion](https://www.typescriptlang.org/docs/handbook/basic-types.html#type-assertions) for the `res.data` returned from the API, we can safely do so because we have the knowledge and expectation that the API would always return an array of `PostData`. Without it, TypeScript would give it a `type` of `any` which will again not be helpful for us.\n\nAt the last part of the code, we added `as const` for the returned array to tell TypeScript that this is a read-only array.\n\n---\n\n## Use the custom API hook in a component\n\nNow let's put our custom API hook into action by using it in a component. Let's update our `App.tsx` code with the following below:\n\n```tsx\n// src/App.tsx\n\nimport { useGetPosts } from './lib/api-hooks';\nimport { FetchState } from './types';\nimport './App.css';\n\nfunction App() {\n  const [posts, fetchState, getPosts] = useGetPosts();\n\n  return (\n    \u003cdiv className=\"container\"\u003e\n      \u003ch1\u003eReact TypeScript API hooks\u003c/h1\u003e\n      {fetchState === FetchState.DEFAULT \u0026\u0026 (\n        \u003c\u003e\n          \u003cp\u003e\n            Hello there, click the button below to get the list of posts from\n            the API.\n          \u003c/p\u003e\n          \u003cbutton onClick={getPosts}\u003eGet Posts\u003c/button\u003e\n        \u003c/\u003e\n      )}\n      {fetchState === FetchState.LOADING \u0026\u0026 \u003cp\u003eFetching posts...\u003c/p\u003e}\n      {fetchState === FetchState.ERROR \u0026\u0026 (\n        \u003c\u003e\n          \u003cp\u003eOops! Something went wrong. Please try again.\u003c/p\u003e\n          \u003cbutton onClick={getPosts}\u003eGet Posts\u003c/button\u003e\n        \u003c/\u003e\n      )}\n      {fetchState === FetchState.SUCCESS \u0026\u0026 (\n        \u003c\u003e\n          \u003cp\u003eHere's the list of posts:\u003c/p\u003e\n          \u003cul className=\"posts-list\"\u003e\n            {posts.map((post) =\u003e (\n              \u003cli key={post.id} className=\"post\"\u003e\n                \u003ch3\u003e\n                  {post.id} - {post.title}\n                \u003c/h3\u003e\n                \u003cp\u003e{post.body}\u003c/p\u003e\n              \u003c/li\u003e\n            ))}\n          \u003c/ul\u003e\n        \u003c/\u003e\n      )}\n    \u003c/div\u003e\n  );\n}\n\nexport default App;\n```\n\n---\n\nOnce you saved it, your React application should display something like this:\n\n![Screenshot of unstyled React API hook UI](/images/posts/how-to-integrate-with-a-rest-api-using-react-hooks-and-typescript-with-tests/unstyled.png)\n\nNow before we interact we it, let's update the styles to make our application slightly prettier.\n\n```css\n/* src/index.css */\n\n* {\n  box-sizing: border-box;\n}\n\nbody {\n  margin: 0;\n  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto',\n    'Oxygen', 'Ubuntu', 'Cantarell', 'Fira Sans', 'Droid Sans',\n    'Helvetica Neue', sans-serif;\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n  line-height: 1.6;\n}\n```\n\n```css\n/* src/App.css */\n\n.container {\n  width: 600px;\n  max-width: 100%;\n  margin: 0 auto;\n  padding: 20px 15px;\n}\n\n.posts-list {\n  list-style: none;\n  padding: 0;\n  margin: 0;\n}\n\n.post {\n  margin-top: 10px;\n  padding: 0 15px;\n  border: 1px solid #ccc;\n}\n\n.post h3 {\n  color: #222;\n}\n\n.post p {\n  color: #777;\n}\n```\n\nAlright, now try clicking the \"Get Posts\" button. You should briefly see the loading state:\n\n![Screenshot of React API hook UI in loading state](/images/posts/how-to-integrate-with-a-rest-api-using-react-hooks-and-typescript-with-tests/loading.png)\n\nThen eventually the list of posts:\n\n![Screenshot of React API hook UI in success state](/images/posts/how-to-integrate-with-a-rest-api-using-react-hooks-and-typescript-with-tests/success.png)\n\nAlright, everything is working fine as expected.\n\nIf you would like to see the error state. Simple add a `throw` inside the `getPosts` function like this:\n\n```ts\n\n...\n  const getPosts = async () =\u003e {\n    try {\n      throw new Error(); // TODO: remove this after seeing the error state\n      ...\n    } catch (err) {\n      ...\n    }\n  };\n```\n\nWhen you click the \"Get Posts\" button again. It will display something like this:\n\n![Screenshot of React API hook UI in error state](/images/posts/how-to-integrate-with-a-rest-api-using-react-hooks-and-typescript-with-tests/error.png)\n\nAwesome! Remove the `throw` code and we can start writing tests.\n\n---\n\n## Write tests for App component\n\nUpdate the code of `App.test.tsx` for our first test case which is to check the default state:\n\n```tsx\n// src/App.test.tsx\n\nimport { render, screen } from '@testing-library/react';\nimport App from './App';\n\ndescribe('\u003cApp /\u003e', () =\u003e {\n  const renderComponent = () =\u003e render(\u003cApp /\u003e);\n  const defaultText =\n    'Hello there, click the button below to get the list of posts from the API.';\n  const loadingText = 'Fetching posts...';\n  const errorText = 'Oops! Something went wrong. Please try again.';\n  const successText = \"Here's the list of posts:\";\n\n  it('should render default state', () =\u003e {\n    renderComponent();\n\n    const stateEl = screen.queryByText(defaultText);\n\n    expect(stateEl).toBeInTheDocument();\n  });\n});\n```\n\nHere we defined all the expected description for each states and check whether an element with a text of `defaultText` is in the document.\n\nTo see if our test case passed along with the coverage, run this command on your terminal:\n\n```bash\nyarn test --coverage\n```\n\nYou don't have to run this command again when you make changes, it will automatically re-run just like `yarn start`.\n\nFor the second test case, let's check whether the description is correct during the loading state. We will have to mock the `useGetPosts()` in order to control the state it returns and do the checks. This also ensures that we are not doing an actual fetch to the API. Mocking data fetching with \"fake\" data prevents flaky tests due to an unavailable back-end server and makes our tests run faster too.\n\n```tsx\n// src/App.test.tsx\n\n...\nimport * as apiHooks from './lib/api-hooks';\nimport { FetchState } from './types';\n\ndescribe('\u003cApp /\u003e', () =\u003e {\n  ...\n\n  afterEach(() =\u003e {\n    jest.restoreAllMocks();\n  });\n\n  ...\n\n  it('should render loading state on loading', () =\u003e {\n    const fetchState = FetchState.LOADING;\n\n    jest\n      .spyOn(apiHooks, 'useGetPosts')\n      .mockReturnValue([[], fetchState, jest.fn()]);\n\n    renderComponent();\n\n    const stateEl = screen.queryByText(loadingText);\n\n    expect(stateEl).toBeInTheDocument();\n  });\n});\n```\n\nWhen mocking functions, we would need to call `jest.restoreAllMocks()` after each tests using `afterEach` to revert it back to its original state to prevent it from affecting other test cases.\n\n---\n\nLet's add the code for the third test case to check the error state, it would be similar from the previous test case:\n\n```tsx\n  ...\n\n  it('should render error state on error', () =\u003e {\n    const fetchState = FetchState.ERROR;\n\n    jest\n      .spyOn(apiHooks, 'useGetPosts')\n      .mockReturnValue([[], fetchState, jest.fn()]);\n\n    renderComponent();\n\n    const stateEl = screen.queryByText(errorText);\n\n    expect(stateEl).toBeInTheDocument();\n  });\n});\n```\n\nNext, for the fourth test case, we will check whether both the expected description is rendered as well as the post data. We can make use of the library [faker](https://github.com/marak/faker.js) to generate random data for us which makes our test more reliable.\n\n```tsx\n// src/App.test.tsx\nimport faker from 'faker';\n\n  ...\n\n  it('should render success state on success', () =\u003e {\n    const fetchState = FetchState.SUCCESS;\n    const posts = [\n      {\n        userId: faker.datatype.number(),\n        id: faker.datatype.number(),\n        title: faker.lorem.sentence(),\n        body: faker.lorem.sentences(),\n      },\n    ];\n\n    jest\n      .spyOn(apiHooks, 'useGetPosts')\n      .mockReturnValue([posts, fetchState, jest.fn()]);\n\n    renderComponent();\n\n    const stateEl = screen.queryByText(successText);\n    const post = posts[0];\n    const postTitle = `${post.id} - ${post.title}`;\n    const postEl = screen.queryByText(postTitle);\n\n    expect(stateEl).toBeInTheDocument();\n    expect(postEl).toBeInTheDocument();\n  });\n});\n```\n\nFor the last test case of `App.tsx`, we just need to check that the `getPosts` function from the custom hook is called when the \"Get Posts\" button is clicked. Add the following code below:\n\n```tsx\nimport { fireEvent, render, screen } from '@testing-library/react';\n  ...\n\n  it('should call API on button click', () =\u003e {\n    const getPostsMock = jest.fn();\n\n    jest\n      .spyOn(apiHooks, 'useGetPosts')\n      .mockReturnValue([[], FetchState.DEFAULT, getPostsMock]);\n\n    renderComponent();\n\n    const btnEl = screen.queryByText('Get Posts') as HTMLButtonElement;\n\n    fireEvent.click(btnEl);\n\n    expect(getPostsMock).toBeCalledTimes(1);\n  });\n```\n\nWe are using [fireEvent](https://testing-library.com/docs/dom-testing-library/api-events/) function by Testing Library to fire a click event. It only accepts an element so we had to do a type assertion when querying the button element.\n\n---\n\nIf you check the coverage on your terminal, it should be 100% now for `App.tsx`.\n\nThat's great! Now are the done with the component tests. Let's move on to write tests for our custom API hook.\n\n## Write tests for custom API hook\n\nFor the first test case, we just need to check that it returns the expected initial values and function. Add the following code below:\n\n```ts\n// src/lib/api-hooks.test.ts\n\nimport { renderHook } from '@testing-library/react-hooks';\nimport { FetchState } from '../types';\nimport { useGetPosts } from './api-hooks';\n\ndescribe('api hooks utilities', () =\u003e {\n  describe('useGetPosts()', () =\u003e {\n    const renderCustomHook = () =\u003e renderHook(() =\u003e useGetPosts());\n\n    it('should return initial value', () =\u003e {\n      const hook = renderCustomHook();\n      const [posts, fetchState, getPosts] = hook.result.current;\n\n      expect(posts).toEqual([]);\n      expect(fetchState).toBe(FetchState.DEFAULT);\n      expect(typeof getPosts).toBe('function');\n    });\n  });\n});\n```\n\nFor the second test case, let's check whether it is calling the expected API endpoint when the function is executed.\n\n```ts\nimport { act, renderHook } from '@testing-library/react-hooks';\nimport axios from 'axios';\n\n    ...\n\n    afterEach(() =\u003e {\n      jest.restoreAllMocks();\n    });\n\n    ...\n\n    it('should have expected endpoint on api call', async () =\u003e {\n      const axiosGetSpy = jest\n        .spyOn(axios, 'get')\n        .mockResolvedValue({ data: [] });\n\n      const hook = renderCustomHook();\n      const getPosts = hook.result.current[2];\n\n      await act(async () =\u003e {\n        await getPosts();\n      });\n\n      expect(axiosGetSpy).toBeCalledTimes(1);\n      expect(axiosGetSpy).toBeCalledWith(\n        'https://jsonplaceholder.typicode.com/posts'\n      );\n    });\n  ...\n```\n\nWe are mocking the `axios` here to prevent doing an actual fetch. We also used [act](https://reactjs.org/docs/testing-recipes.html#act) function which makes sure all updates related to this action have been processed and applied to the DOM before we make any assertions. This is usually done when the function you executed in the test case makes an update on the React states. When also added `async` and `await` because `getPosts()` is an asynchronous function and ideally we should wait for it to be done before we do our checks.\n\nFor the third test case, we need to check whether we are getting the expected states on API call, we are expecting we will get a loading state while waiting for the API to return the response. Here's the code for that:\n\n```ts\n    ...\n\n    it('should have expected states on api call', async () =\u003e {\n      jest.spyOn(axios, 'get').mockResolvedValue({ data: [] });\n\n      const hook = renderCustomHook();\n      const getPosts = hook.result.current[2];\n\n      const promiseAct = act(async () =\u003e {\n        await getPosts();\n      });\n\n      const [posts, fetchState] = hook.result.current;\n\n      expect(posts).toEqual([]);\n      expect(fetchState).toBe(FetchState.LOADING);\n\n      await promiseAct;\n    });\n  ...\n```\n\nAs you would notice, we didn't do an `await` for the `act` function right away, we had to store it in a variable and do an `await` at the end because if we didn't, we would be getting `FetchState.SUCCESS` instead which is for a later test case.\n\n---\n\nFor the fourth test case, we need to check whether we are getting the expected state when the API fails. Add the following code below to do so:\n\n```ts\n    ...\n\n    it('should have expected states on api error', async () =\u003e {\n      jest.spyOn(axios, 'get').mockRejectedValue({});\n\n      const hook = renderCustomHook();\n      const getPosts = hook.result.current[2];\n\n      await act(async () =\u003e {\n        await getPosts();\n      });\n\n      const [posts, fetchState] = hook.result.current;\n\n      expect(posts).toEqual([]);\n      expect(fetchState).toBe(FetchState.ERROR);\n    });\n  ...\n```\n\nHere we are mocking `axios` with `.mockRejectedValue({})` in order to throw an error when fetching the data.\n\nFor the last test case, we need to check whether we are getting the expected state when the API succeeds. This time the posts should not be an empty array. We will use `faker` library again to mock the data for us. Here's the code below:\n\n```ts\nimport faker from 'faker';\n\n    ...\n\n    it('should have expected states on api success', async () =\u003e {\n      const res = {\n        data: [\n          {\n            userId: faker.datatype.number(),\n            id: faker.datatype.number(),\n            title: faker.lorem.sentence(),\n            body: faker.lorem.sentences(),\n          },\n        ],\n      };\n\n      jest.spyOn(axios, 'get').mockResolvedValue(res);\n\n      const hook = renderCustomHook();\n      const getPosts = hook.result.current[2];\n\n      await act(async () =\u003e {\n        await getPosts();\n      });\n\n      const [posts, fetchState] = hook.result.current;\n\n      expect(posts).toEqual(res.data);\n      expect(fetchState).toBe(FetchState.SUCCESS);\n    });\n  ...\n```\n\n---\n\nAnd they're you have it!\n\nBy now, you should have achieved 100% test coverage and all looking green in your terminal just like this:\n\n![Screenshot of React API hook UI 100% Test Coverage](/images/posts/how-to-integrate-with-a-rest-api-using-react-hooks-and-typescript-with-tests/test-coverage.png)\n\nIf you're up for a challenge, try creating your own custom API hook with the rest of the APIs by JSONPlaceholder [here](https://jsonplaceholder.typicode.com/guide/) using what you've learned from this post.\n\nIn case you need the final code as a reference, this is the [link](https://github.com/dominicarrojado/react-typescript-api-hooks) to the GitHub repository.\n\nPlease don't forget to share this post if you find it helpful. Thank you ~\n","previousPost":{"id":"the-turning-point","title":"The Turning Point","date":"2021-10-17","excerpt":"A critical time in your life where big decisions could lead to big change, both at work and in life","category":"personal","videoUrl":""},"nextPost":{"id":"how-to-create-your-own-swiper-in-react-and-typescript-with-tests-part-1","title":"How to create your own swiper, carousel or slider in React and TypeScript with tests (Part 1)","date":"2022-02-11","excerpt":"Learn how to build a modern mobile touch swiper in a reactive and reusable way","category":"technology","videoUrl":"https://youtu.be/V0dfhBc2lj8"},"title":"How to integrate with a REST API using React Hooks and TypeScript with tests","date":"2021-12-04","excerpt":"Learn how to integrate with a REST API in a reactive and reusable way","category":"technology","videoUrl":"https://youtu.be/LkumZ2Z7bbs"}},"__N_SSG":true},"page":"/posts/[id]","query":{"id":"how-to-integrate-with-a-rest-api-using-react-hooks-and-typescript-with-tests"},"buildId":"UQD9M7dkedoXqXN1-gQoy","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>